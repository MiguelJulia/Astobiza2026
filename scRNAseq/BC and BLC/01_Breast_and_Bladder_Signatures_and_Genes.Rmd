---
title: "Breast and bladder gene and signature expression"
author: "Miguel JuliÃ¡"
date: "2024-01-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Abstract

For scRNAseq datasets (Breast and bladder), we want to investigate expression of genes and signatures in whole tumor clusters and in fibroblast clusters.

We need:
1. Image of whole tumor clusters with identification assigned
2. Image of fibroblast clusters assigned
3. Map of expression in both types of data (whole tumor and fibroblasts) for indicated genes and signatures
4. Expression matrix (average) so we can generate a heatmap or graph (gene and signatures).
5. For the BLCA dataset that we have normal and cancer tissue, expression matrix for gene and signtures of fibroblasts from normal and tumor


## Load dataset together

```{r load data, echo=F}

library(Seurat)
library(ggplot2)
library(SingleR) 
library(dplyr)
library(celldex) ## This is only available with R>=4.0, so load pregenerated data object hpca.ref instead if using R<4.0
library(RColorBrewer)
library(SingleCellExperiment)
library(hdf5r)
library(ggthemes)

setwd("/path/to/working/directory/scRNAseq_test/Signaures")

load("Bladder.srat.combined.RData")
Bladder.srat.combined <- srat.combined
rm(srat.combined)
load("Bladder.srat.fibroblast.only.RData")
Bladder.srat.fibroblasts.only <- srat.fibroblasts.only
rm(srat.fibroblasts.only)

load("Breast.srat.combined.RData")
Breast.srat.combined <- srat.combined
rm(srat.combined)
load("Breast.srat.fibroblast.only.RData")
Breast.srat.fibroblasts.only <- all.fibroblast
rm(all.fibroblast)

```


## 1. Image of whole tumor clusters with identification assigned

Bladder

```{r whole clusters Bladder}

Bladder.srat.combined <- SetIdent(Bladder.srat.combined, value = "seurat_clusters")
DimPlot(Bladder.srat.combined, reduction = "umap", label = TRUE, repel = TRUE)

Bladder.srat.combined <- SetIdent(Bladder.srat.combined, value = "orig.tumour")
DimPlot(Bladder.srat.combined, label = T , repel = T, label.size = 3) + ggtitle('Tumour state Fibrolasts all')

Bladder.srat.combined$hpca.reduced <- Bladder.srat.combined$hpca.main
for (cell_type in c("Astrocyte", "CMP", "Erythroblast", "Neurons", "Pre-B_cell_CD34-", "DC", "Neutrophils", "Pro-B_cell_CD34+", "BM & Prog.", "GMP", "Hepatocytes", "MSC", "Osteoblasts", "HSC_CD34+") ){
  Bladder.srat.combined$hpca.reduced[ Bladder.srat.combined$hpca.reduced == cell_type] <- "NA"
}
Bladder.srat.combined$hpca.reduced[ Bladder.srat.combined$hpca.reduced == "NK_cell"] <- "T/NK cell"
Bladder.srat.combined$hpca.reduced[ Bladder.srat.combined$hpca.reduced == "T_cells"] <- "T/NK cell"

Bladder.srat.combined <- SetIdent(Bladder.srat.combined, value = "hpca.reduced")
DimPlot(Bladder.srat.combined, label = F , repel = T, label.size = 3) + ggtitle('Tissue types Fibrolasts all')

list_fibroblasts <- WhichCells(Bladder.srat.combined, idents = c( "Fibroblasts"))
DimPlot(Bladder.srat.combined, label=T, cells.highlight= list(list_fibroblasts), cols.highlight = c("darkblue"), cols= "grey")

```

Breast

```{r whole clusters Breast}

Breast.srat.combined <- SetIdent(Breast.srat.combined, value = "seurat_clusters")
DimPlot(Breast.srat.combined, reduction = "umap", label = TRUE, repel = TRUE)

Breast.srat.combined$cell_type[ is.na(Breast.srat.combined$cell_type) ] <- "NA"

Breast.srat.combined <- SetIdent(Breast.srat.combined, value = "cell_type")
DimPlot(Breast.srat.combined, label = F , repel = T, label.size = 3) + ggtitle('Tissue types metadata')

Breast.srat.combined <- SetIdent(Breast.srat.combined, value = "cell_type")
list_fibroblasts <- WhichCells(Breast.srat.combined, idents = c( "fibroblast"))
DimPlot(Breast.srat.combined, label=T, cells.highlight= list(list_fibroblasts), cols.highlight = c("darkblue"), cols= "grey")

```


## 2. Image of fibroblast clusters assigned

Bladder

```{r fibroblasts clusters Bladder}

Bladder.srat.fibroblasts.only <- SetIdent(Bladder.srat.fibroblasts.only, value = "seurat_clusters")
DimPlot(Bladder.srat.fibroblasts.only, reduction = "umap", label = TRUE, repel = TRUE)

Bladder.srat.fibroblasts.only <- SetIdent(Bladder.srat.fibroblasts.only, value = "orig.tumour")
DimPlot(Bladder.srat.fibroblasts.only, label = T , repel = T, label.size = 3) + ggtitle('Tumour state Fibrolasts all')

```

Breast

```{r fibroblasts clusters Breast}

Breast.srat.fibroblasts.only <- SetIdent(Breast.srat.fibroblasts.only, value = "seurat_clusters")
DimPlot(Breast.srat.fibroblasts.only, reduction = "umap", label = TRUE, repel = TRUE)

```


## 3. Map of expression in both types of data (whole tumor and fibroblasts) for indicated genes and signatures

Gene and expression bladder

```{r gene expression Bladder}

DefaultAssay(Bladder.srat.combined) <- "RNA"

marker_gene_list <- list(c( "KRT1","LUM","PHLDA1","C5ORF13","PRRX1","EIF1AX","GPR56","RUNX1","POU2AF1","MOK","HN1","GTPBP8","TARBP1","EREG","SFRP4","COL1A1","CXCL12","MARCKS","COL5A1","FAP","XIST","TGFBI","TCTA","EPHA3","LEF1","SATB1","SATB2","SERPINE1","SERPINE2","CRABP2","TNC","CALML5","CXCL14","LOXL1","FOXO3","SLC5A6","HOXA10","COMP","TRBC1","CDH2","DPYSL3","MYC","SPOCK1","CYP1B1","GRB10","EGR1","CPA3","JAG1","NOP16","SMAD1","IGFBP3","INHBA","AMMECR1","ACLY","SQLE","FOSL1","LOX","SNAI2","IGKV4-1","FBN1","BIRC3","IL7R","INSIG1","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","CNN3","LGALS3","C1QTNF3","NETO2","ANPEP","AMDHD2","HMOX1","SOX9","IER3","EIF5A","MMP2","GGH","MMP3","GFPT2","CFLAR","VEGFC","LIF","TUBB2A","MTSS1","PDZK1IP1","IGLJ3","MFAP5","VCAN","MFAP2","CPE","CD27","TAX1BP3","CD24","ITK","KHDRBS3","COL14A1","TNFAIP6","PEA15","SGPL1","DSE","RRAS2","COL10A1","RRS1","CCR7","MAN1A1","LMCD1","CEP170","DACT1","SERPINB4","IL32","SERPINB3","TMEM176B","ADAM12","BGN","KLF4","ASPN","KLF7","TMEM158","GREM1","FABP5","STK17A","ALDH1A3","LRRC15","IGHM","LRRC17","SEMA3C","THBS1","MSMO1","THBS2","ATP5G1","ROBO1","POLD4","SPTLC2","PTPRZ1","LEPROTL1","COL11A1","AGA","CCL2","ITGAV","CD59","CCL19","EPHB2","CYTH1" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "LJP005_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Bladder.srat.combined, features = "LJP005_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "TFAP2B","PDGFRA","PHLDA1","C5ORF13","TLE1","MX1","S100A2","MOK","TM4SF1","SFRP4","IFI44L","SCD","AXL","COL5A1","XIST","SCG2","CNIH4","DEGS1","LEF1","SERPINE1","SERPINE2","TNC","CXCL14","LOXL1","COMP","NT5E","DPYSL3","MYC","SPOCK1","NPTX2","GRB10","PHLDA2","LDLR","FDFT1","IGFBP2","CARD10","JAG1","PMM2","SMAD1","IGFBP3","C13ORF15","INHBA","PRKCA","FOSL1","SLC6A8","EIF5","LOX","MAL","PRPF4","COL6A2","SNAI2","CDC42EP3","TAGLN2","IL7R","SPON1","INSIG1","AK4","PLAU","HIF1A","ELK3","C3","CNN3","RGS3","MICAL2","FAM162A","NKX3-1","KIAA0226L","IER3","FGFBP1","MMP7","JUN","TNFRSF12A","GFPT2","CFLAR","EMP1","APOA2","NRG1","TUBB2A","CDC42BPA","MTSS1","ENAH","PDZK1IP1","MMP10","NFKBIA","VCAN","TF","ARL4C","TUBB2B","ID1","CILP","ITGA6","TAX1BP3","CD24","NVL","REG3A","NID1","AEBP1","TNFAIP2","HK1","UCHL1","COL10A1","LMCD1","PACSIN2","IL32","EGLN3","SPAG4","BGN","SULF1","KLF4","RNASE1","GAL","KLF7","CLEC2B","KLF6","PALLD","ALDH1A3","NDUFA4L2","SPRY4","TRIB2","SRPX","LRRC15","IGHM","ECM1","THBS1","THBS2","COL11A1","BNIP3","CCL2","ITGAV","UPP1","EPHB2" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "LJP009_HA1E_24H-tanespimycin-10_score")
FeaturePlot(Bladder.srat.combined, features = "LJP009_HA1E_24H-tanespimycin-10_score1")

marker_gene_list <- list(c( "ANXA1","EIF5A","CDKN2A","F2R","AMFR","EIF2S3","COL1A2","BST2","VCAN","COL3A1","GREM1","FABP5","ID3","PLBD1","PFN2","CD24","TLR4","FGFR3","TMEM45A","IL7R","IFITM2","SPARC","NRN1","IFITM3","TYRP1","SATB1","IFITM1","HBB","ADM","KRT23","IFI6","KRT20","THBS2","LOXL2","CTSS","CYR61","HOXA10","ARHGDIA","THBD","UCHL1","ARHGDIB","COL11A1","CD59","CD36" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "LJP006_BT20_3H-geldanamycin-10_score")
FeaturePlot(Bladder.srat.combined, features = "LJP006_BT20_3H-geldanamycin-10_score1")

marker_gene_list <- list(c( "SLC16A1","PDGFRA","PHLDA1","C5ORF13","TLE1","LMO4","GPR56","MOK","HN1","VCAM1","COL1A1","WT1","CXCL12","BOP1","IGL","AXL","CRISPLD2","COL5A1","FAP","CD9","ITGBL1","CYP1A1","PRSS2","SERPINE1","ODC1","SERPINE2","TNC","LOXL1","HOXA10","EFNB2","COMP","TUBB6","TRBC1","CDH2","DPYSL3","ALOX5","PEG10","MYC","IGKC","TPM1","SPOCK1","CYP1B1","GRB10","ARHGEF40","EGR1","CPA3","POSTN","JAG1","EGR3","IGFBP3","INHBA","IGF1","MINA","MAFB","CKAP4","ACLY","SQLE","FOSL1","CREB1","EIF5","COL6A1","LOX","COL6A2","SPATS2L","SNAI2","FBN1","CFD","SPON2","ATP6V1D","INSIG1","PDGFC","GATA6","AK4","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","LIPA","C3","LGALS3","C1QTNF3","C7","ANPEP","AMDHD2","PMEPA1","TSPAN7","HMOX1","TPSAB1","IER3","MMP2","GGH","GFPT2","CFLAR","EMP1","VEGFC","FN1","LIF","TUBB2A","MTSS1","MFAP5","VCAN","RAP2B","MEIS1","MFAP4","ALB","BHLHE40","CILP","FXYD2","TAX1BP3","COL14A1","TNFAIP8","THY1","CLEC7A","TIMP3","RRS1","LMCD1","PCK2","DACT1","TIMM8B","SERPINB2","IL32","ADAM12","QPCT","AKR1C3","LSS","KLF2","ASPN","KLF7","TMEM158","CLEC2B","FABP5","RPIA","ALDH1A3","MAP1B","VDAC1","CD44","SRPX","LRRC15","IGHM","LRRC17","F13A1","AMIGO2","SEMA3C","THBS1","AFP","SRM","THBS2","POLD4","AKAP12","ADAMTS1","PNMA1","NEFL","CCL2","ITGAV","EPHB2","CYTH1" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "LJP006_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Bladder.srat.combined, features = "LJP006_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "COL11A1","ZNF469","SULF1","FAP","KIF26B","MMP11","NOX4","COL5A2","GRP","COL10A1","TBC1D8B","CTSK","TBX15","COMP","FNDC1","RASAL2","HEYL","WISP1","COL8A1","ANTXR1","CNIH3","OLFML2B","CMTM8","LAYN","THBS2","ZNF587","IL13RA1","SIRPA","FKBP9","FGF18","ANGPT2","NOTCH4","GZMB","CHSY1","MMP7","RNF149","LOXL1","MRPS10","LAMP1","FBN1","MYH9","EXOC5","MORC4","IFITM1","CD93","PNPO","APBB2","PCDH17","KCNQ1","EGFL6","CDS2","SULF2","AMDHD2","ITPK1","CTDSP2","ARF4","GALNT10","SOCS3","IGFBP7","FBXO22","LRRC32","BCL2L1","ADAM12","ARL8A","MAML1","ADAMTS2","ITGA11","ELMOD2","HSD3B7","CECR5","TMEM109","DNAJB2","SPIN3","JUNB","GALNT1","RAI1","EHMT1","WSB2","AEBP1","ARMCX5","SPARC","INHBA","EVC","MAPRE1","CD248","BPGM","PPAPDC1A","C2","STARD3NL","ALDH1A3","PCBD1","CTHRC1","PDPN","ATP2A2","CYFIP1","DDAH2","TMEM30A","PQLC3","PCDHB10","HSPH1","PCID2","KAL1","LAMP2","RNF187","CCDC92","KRT23","NCK2","RAB15","BMP1","TNFSF4","CXCL2","PTPN12","CMTM4","ZNF668","SEPT8","ADAMTS6","QDPR","C1QTNF6","OSM","MYH10","SUMF1","IMPACT","GLB1","EDNRA","ANKH","CNP","B3GALT6","DYNLT1","MMP16","CD3EAP","SFXN3","RAB18","ABL2","DKK2","ELMO2","FZD8","LRRC15","PTP4A3","IFITM3","SEMA5A","ATP6V1C1","PPEF1","TRAM1","DDB1","FOLH1","BICC1","ADAMTS12","GLMP","TGFBRAP1","MFAP2","TMEM132A","C8orf34","FBXL20","GOLGA5","NECAP2","EFNB2","BAP1","IFITM2","BZW2","CXCL10","PTPLAD1","ISLR","GNB1","SCYL2","RAB40C","GJA5","SPOUT1","FASTKD2","PEX7","DEXI","MYB","GTF3C1","CD82","DIAPH3","ABHD11","UBAP2","KDR","HOXB8","KIF9","EFEMP2","XPO4","CLTC","DIABLO","CALU","ZNF282","TRIM29","CXCL6","CSNK1G3","VPS41","TMCO3","EPHB2","STARD4","PTPRG","TRIM68","EXOSC4","POLE3","PRPF4","SOX9","NEK1","FJX1","CACNA1D","HECW2","ADCK2","SLC12A8","DUSP14","JAG2","PIGW","TMED1" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "STROMA hi BC OV CR_score")
FeaturePlot(Bladder.srat.combined, features = "STROMA hi BC OV CR_score1")

gene_list_too_long_1 <- c( "FGF2","PKP1","INHBA","JUP","ADCY7","SLC20A1","ENDOD1","TUBB3","HBEGF","NES","SEMA7A","WHRN","TNNT2","CNNM4","ITGB3","TRIM66","HR","MEGF10","OLR1","LRRC8C","ARL4C","CMKLR1","NIPAL1","LAD1","DUSP6","MED14","THBS1","WNT5A","PMAIP1","KCTD11","NUAK2","ZC3H12C","COQ10B","MN1","TBX3","SKIL","CTDP1","BHLHE40","ZSWIM6","WNT11","RAP1GAP2","PIEZO2","PMEPA1","VEGFA","TNFRSF21","IRAK2","MYO1E","CARD10","IGF2BP3","MAP6","SEC14L2","RYBP","LRRC8B","GREM2","SMAD7","TMCC2","PCDH7","ASAP2","ITGA5","COTL1","DZIP1L","LAMB3","TTC39B","GPR39","SCHIP1","PLAU","PHTF2","PTGS1","DENR","GDPD5","PPP1R13L","HOMER1","MOB3B","VOPP1","RDH10","FKBP5","F2R","MICAL2","YWHAQ","CNTN2","BLCAP","OTUD4","KANSL3","PIP4K2A","PLAUR","RASA1","SLC7A1","POLR3D","ZFPM1","ARPC2","LRRC15","NRIP1","IGSF3","PKIA","NIN","ACOT7","IVNS1ABP","PRG4","SLC25A30","ABRACL","ANO1","OSGIN2","ARID5A","RUNX1","TGIF1","CBLB","TUBA1A","NAV1","PRKG2","COL5A3","LRRC75A","KIAA1671","ARNT2","TNS3","CAMSAP2","ZNF451","RNF19B","MTFR1","AP1S3","SMOC1","PHYHIPL","CHST11","ANTXR2","GPR161","MLLT11","ADCY1","RGS20","SYT11","TAGLN","AGO2","SPSB1","SORCS2","CNN3","NNT","DOCK8","PLAGL1","SEPT11","DGCR8","NCOR2","ZMIZ1","AHCY","SH3BGRL2","LARP1B","RAB31","GOLM1","ZYX","KLHDC8A","CSNK1E","FOXN2","SMURF2","ACSL6","SOCS2","TMSB10","DDAH1","EVA1A","ALCAM","RELT","ARHGEF5","PSTPIP2","EGR2","FOXP4","B4GALNT1","FBLIM1","ADNP","ANGPTL4","PIK3C2B","RRN3","DBN1","ANKRD1","ZBED4","ADRM1","WNT7B","KPNA4","CTSF","HOMER3","PLEKHG3","RBMS1","CDR2","UTP18","BOK","TMEFF1","CYTH4","RTN2","PIM1","HES1","NFKB1","TATDN2","BPIFC","LMCD1","DPYSL3","TNS1","UCN2","AGAP1","L3MBTL3","SMIM15","BRD1","RRS1","SYDE2","GLI3","LTV1","UTRN","CTSW","CD200","MAST4","IL11","PRR5","MYH9","ZNF266","KCNN3","B3GNT2","UBXN2A","DDAH2","CCDC97","NEDD9","LUZP1","PFKFB4","EAF1","IDH3A","LIN7C","NFATC1","SMTN","RNF4","C1QL1","FUBP1","SNAI1","ANKH","MAFF","PTPN12","FASTKD5","SLC39A6","PHLDB2","TES","HACE1","MYO19","IL34","FBXO30","TIMP1","EIF4G2","TMEM200A","CDYL2","ATP2B4","HMCN2","JADE1","PRDM1","SSR3","CDV3","STARD10","ARIH1","CCDC34","CHD1","WNT9A","PDZD8","MYO1D","FES","GABPB1","KCNH1","CRLF1","DNAJC21","ACTG1","RDH8","TPM3","TANC1","FBXL16","FERMT2","E2F3","LITAF","SUCO","USP34","TAGLN2","LYSMD3","PAK4","NOP58","MPHOSPH6","CDC42SE2","GRK6","RNF6","HSPA4","DNAJA4","UBE2J1","ERCC1","KPNA1","ATP1A3","CDC73","VASH1","MAFG","FOXP1","PDLIM7","CDK12","GLCE","ATG9B","CXorf38","CSRP1","RAP1GAP","ACTB","ZNF362","TAB3","GK5","SEMA6A","ZNF518A","ELAVL1","RAB6A","MSN","YLPM1","MTMR7","GABBR1","FRK","SMAD2","IRS2","NAPG","FPGT","ATF4","M6PR","IRF2BPL","AKIRIN1","KCTD15","TMEM168","PARD3","TPD52","TEC","CCDC112","COL27A1","LIMD1","ARMC5","FAM156B","FAM156A","FYN","RAPH1","OSBPL6","PHF2","PPHLN1","KCNK12","IER2","DHX33","SPRED1","RAB11FIP3","NMD3","LDLRAD4","DLG3","GJA4","USP39","CACNA1I","CHML","ZNF821","WDFY3","FURIN","CHD5","LRP5","SHROOM3","MCF2L","SWAP70","EPC2","UBE2F","NCOA6","PPP3R1" )
gene_list_too_long_2 <- c( "PRKRIP1","PTGFRN","TUFT1","UNC45A","TYW5","PREP","CSK","CRABP1","TPM4","GPATCH11","UCHL1","ITGB1","KLC2","IL17RD","SAP30BP","SBK1","TRIM46","NPLOC4","APPL1","ARFGEF1","MYO10","PLK3","NPPB","XPOT","ZFP64","STK39","SYN1","MAP4K4","ZFYVE9","ARMCX2","RHEB","CCAR1","PRSS22","PTAR1","KBTBD2","HSBP1L1","ACTR2","TRIM33","PNO1","SYT6","HSPA13","UBTD1","TAB2","ESF1","FZD2","CHRNB1","LEF1","VPS37A","GCNT2","SS18","SYNJ2","TMEM132A","CALCRL","ZZZ3","TMSB4Y","LATS1","FAM104B","RNF121","PITPNB","PTPRN","GLI1","TMEM39B","CAMSAP1","ZNRF2","PLAA","PTGES3","PXDN","ELL2","MOB4","EXOC5","PDCL","BZW1","TMEM47","ZNF274","NBN","PAPOLA","TMEM158","SMC5","PDZRN3","AK1","TRRAP","WASL","SERP1","NCOA7","ZNF322","TSG101","PRMT5","USP10","PTPN21","RASSF8","DYRK2","FOXJ3","SENP6","PPARGC1B","ACTA1","LSM14B","UBQLN2","ARID3A","PSMC6","CAB39","MTX3","RBBP5","GPER1","ITFG2","KCTD3","UBE2J2","TNK2","WWP1","ANXA8L1","ANXA8","LPIN3","CSRNP2","MALT1","LRRC47","PPRC1","RIOK2","PCGF3","RAD54L2","XPO4","ATP2A2","EVI5","ADCYAP1R1","ZFP91","HK2","SSX2IP","TRIM27","MYADM","GOLIM4","GRHL2","DCUN1D1","SRI","CLTC","TRIP10","ZNF148","SMAD1","UBFD1","CCDC24","EIF1AD","PFN1","PFKP","JMJD6","RAI14","NUP153","MTHFD2","EFNB1","GPBP1L1","AOC2","EXT1","PDCL3","TNFAIP6","MRPL20","EHBP1L1","INO80E","RNF8","THAP1", "ZC3H15","EEF1E1","REPS1","GAD1","CNOT7","RASA3","TWF1","AP1G1","PEPD","WRNIP1","MAML1","TNC","SMARCE1","RAB11B","CEBPA","RIPK1","CHSY1","INIP","GNB1","R3HCC1","EFNB2","ARHGEF40","BAG2","GDPD1","PLS3","MTERF3","PIGG","SMARCD1","NPAS4","USP9X","ATXN2L","ARFIP1","SHROOM2","FBXO21","GLIS2","CEMIP","TTC33","GSTO1","ARID1A","SAMD14","YAF2","TXNDC17","SEMA4C","ATN1","CRCP","HYOU1","TMBIM1","PYGO2","LYSMD2","FLRT2","MSL1","BDH1","KCNN4","NHLRC2","PHLDA3","EIF2S1","ARHGAP32","PHYHIP","TRIM9","CGN","BMPR2","YWHAG","KCMF1","PLP2","PLEKHA5","SP4","MCAM","ESYT2","TBX18","PPM1B","KALRN","ANKRA2","CXADR")
gene_list_too_long_3 <- c( "LMAN1L","WDR45B","NAA15","NOL4L","LOXL2","ANXA6","TRIM36","NOL10","TNPO3","UBE2D1","ANKRD11","UBE2K","OLFM2","POLR2C","RFXANK","RABEP2","IFRD1","EXOC1","NAP1L4","SERPINE1","RABGEF1","POLR3B","GAR1","TJP1","OSBPL3","RAB11FIP4","SSBP1","IPPK","FAM118B","DDX31","KLC1","SPSB4","ZNF236","SRP9","PTGS2","TP53BP2","EPHA3","RPF1","PDE4D","WNT1","FAM118A","SMIM14","ZDHHC5","FEZ2","FSTL3","ABR","FZD6","DAD1","TSPYL2","RALA","CD24","DVL3","NPR3","CSNK1G1","TRAPPC13","GPSM1","ALKBH8","CRISPLD2","ACTN1","ACTR1B","RAB11FIP1","SEC24B","KLF11","NOL4","BCL7A","HTATSF1","BRWD1","GTPBP4","SCAF4","RUFY1","FNBP1L","FIZ1","C1GALT1","ARHGDIA","RAP2A","SCAMP5","TMOD2","KRT79","PHF10","USP7","PRPF39","SLC35E4","JUNB","STX6","ZNF207","NRBP1","GTF3C4","GATA2","DNAJB12","MAGOH","ZBTB1","PITHD1","RPS6KA2","SHMT2","RASL12","CUL1","YTHDF2","POGZ","CYP51A1","SBDS","USP31","AMMECR1L","CTNNA1","POLB","DDX21","LRRC8A","HNRNPCL1","HNRNPCL4","HNRNPCL2","HNRNPCL3","RASSF3","MORC2","TBC1D1","CTTNBP2NL","CDC14B","CDC14C","NOVA1","GATA3","SKI","DNAJC11","METAP1","DHX15","EFNA1","HAVCR2","EIF2S2","UBE2N","RAD17","SYNGR3","CEBPB","DDX18","SPRY4","SPATA5","TTC19","MYL9","BRIX1","NCBP1","FUBP3","CCSAP","MYLK2","TAF9","SAFB","GAB2","WDR74","CREB3L1","BZW2","PHF20L1","RC3H1","RNF122","BAZ1A","PUF60","NUP54","GP1BB","KAT5","WASF1","RAB39B","NTAQ1","FBXO22","CCDC86","INTS12","PTCH2","BMS1","ATG16L1","BBS12","EIF1B","AMOTL2","ZNF878","PLOD2","PACS1","PTBP2","TFG","ZNF532","RBM6","SLC4A7","PITPNC1","BYSL","E2F6","PHF14","VEGFC","AMOT","PHF12","CYP26B1","WDR1","UAP1","DMTF1","TPR","HRH1","ABCE1","LDB1","SNAPC3","LSP1","IBTK","ZNF592","DOT1L","ARL13B","NUDT15","APCDD1","SUPT16H","PRRC1","LAS1L","YWHAH","MANF","SPRYD7","CPSF7","IL1A","ATP9A","ZMAT3","SEMA4D","CASP8","ZNF142","ARF4","E2F4","INTS7","RSF1","CLU","ZBTB44","CCT2","GZMM","CUL3","CYTH2","GCNT1","STRBP","PRSS23","STRN3","SF3B1","CEP85","INO80","ATAD2B","ZFP57","CD1D","NAF1","DCUN1D5","PABPN1","PIN1","CRIP2","JAG1","ITCH","ITSN1","PPAN","DR1","RHBDF1","AKAP11","GADD45A","OTUD6B","AVPI1","MAPKBP1","RFTN2","IMP4","CLSTN1","USO1","RTKN","BRPF1","STX7","ERP44","PPID","DHX38","ERC1","PHLPP1","TMEM245","CFI","TMEM201","CDIPT","SMCO4","ORC4","ZFR","DNAJC1","CAMK2N1","RBBP6","TCF4","TIRAP","FHL3","STAU2","PXDC1","COL17A1","BMPR1B","C15orf39","WDR47","ADRA2A","MICAL1" )
gene_list_too_long_4 <- c( "MORC4","SDCBP2","ZNF250","SPATA13","KCTD12","FLNA","SHF","ZDHHC16","SUPT20H","NF2","SLC22A4","MYH10","THUMPD1","ZCCHC9","TMEM151A","PCDH1","MIEF1","BUD31","TRIM29","TAF15","SLC25A25","TLE3","BRD4","TIPRL","CHORDC1","IL2RB","NCOA3","RHNO1","FCER1G","ARRB2","CEP104","CSNK2A2","CDYL","MICAL3","CALM1","CALM3","CALM2","CCDC102A","FAM219A","GTF2A1","C18orf21","KCNG1","SOCS5","GOLPH3","FPGS","EDRF1","MRPL16","MLLT1","TNFRSF4","NR2C2AP","WDR75","TIMM23","PTHLH","PQBP1","ACIN1","DDX54","RSL1D1","KLF10","LYN","PTPN9","TNS2","CACNA2D1","GPRIN1","DAZAP2","CABP1","TMEM33","ZMYM4","PRPF3","DROSHA","ITGB1BP2","AKTIP","SH3BP2","HNRNPL","ADIPOR2","SAFB2","NANS","SNX7","DDHD1","ZNF800","RAB21","FUS","ZNF827","ZBTB47","HOXA3","ISL2","RBM25","RSL24D1","CBX1","UCK1","ADAMTS4","MAFA","GORASP2","EIF3A","PSMD7","TMX1","RNF19A","SAP25","PRX","ADAMTSL3","SMYD5","RANBP2","USF2","PAFAH1B1","FBN1","RBSN","ENY2","RAB3C","ADGRG5","TMEM11","CLIP2","STAM","TBXT","OTUD7B","GTF2E1","PLRG1","CBFB","TMEM59L","OSBPL11","OSBP2","POLR2H","CEP170","GPN2","FCRLB","PFDN1","SMAD4","PPP2R2A","DDX5","NRARP","RNF103","PRPF4B","ACSL4","IARS1","SGTB","FBXO11","WDR4","DDX52","GGNBP2","MAPKAPK2","CUL5","SRP54","RGS16","SNX11","F2RL2","CFAP20","ACBD3","NT5E","ZNF778","ZNF487","PDE12","PELP1","PPP1R15A","GRB2","HAS1","SLCO5A1","GLS2","CKB","TMED2","ADGRL3","B4GALT1","KLRB1","LIMK1","GTF3C3","ACSL3","HIF1AN","IL6","ZDHHC20","SLMAP","AIF1L","CCDC88A","MED7","ARID4A","KIAA1328","EIF3J","PFDN4","KLHL30","UTP6","RAB23","RICTOR","YARS2","TAF13","PCMTD1","KCNH5","TAF3","DAB2IP","DSTN","SNIP1","CCDC59","MDM2","RSRC2","ESRRA","PTK2B","FGL2","UNC5B","DDX46","THOC7","AAK1","ACTG2","TARS1","PLEKHB1","MPHOSPH10","TRA2B","GARS1","CKAP4","C4orf3","EIF4ENIF1","SP3","PDCD10","MPLKIP","POGK","TCEAL8","AMPD2","NAT14","NFXL1","HDAC7","PRDM10","BAMBI","SMOC2","CGGBP1","RUFY3","RAB2A","LGR6","KLHL11","SART1","BCLAF1","PGBD5","PAWR","SIN3B","DPP9","PKP3","MMP17","CREB1","SH2B1","FBXW11","NOP14","PRCC","TMEM81","TOMM34","DDX47","BPTF","ETS2","BATF3","ASTE1","GPT2","ZBTB21" )
marker_gene_list <- list(c( gene_list_too_long_1 , gene_list_too_long_2, gene_list_too_long_3, gene_list_too_long_4 ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "CAF NOT mNF+T HSP90A specific genes_UP_score")
FeaturePlot(Bladder.srat.combined, features = "CAF NOT mNF+T HSP90A specific genes_UP_score1")

marker_gene_list <- list(c( "FHL1","BASP1","AXL","FBLN1","CTGF","TIMP3","CCL2","COL8A1","FIBIN","EFEMP2","LHFP","PLAU","NDN","SLC24A3","RGS16","COL11A1","INHBA","F3","TNFAIP6","FRZB","NDE1","S1PR3","WNT2B","CXCL1","SVEP1","KDELR3","FBLN5","SYDE1","SEPT11","MARCKS","CHN1","ZMAT3","AKAP12","LMO4","AKR1B1","PPP1R14A","NOTCH2","ADAMTSL4","TPM1","WISP1","CRMP1","GPR176","DCBLD2","TPBG","PELO","ADM","CXCL10","GXYLT2","ERRFI1","ANTXR2","APCDD1","GPX7","MAN1C1","PARVA","STEAP2","SMARCA1","ACTG2","STEAP1","YAP1","RNF144A","SMTN","FHL2","MOXD1","NEXN","FARP1","C2CD2","CYP1B1","FST","LCAT","MICALL2","TEAD1","EPHA3","PDLIM2","MEST","WBSCR17","KIAA1199","HSPA12A","NUCKS1","KIAA1211","HAS2","NCS1","NEK6","SSR1","UCN2","SGMS2","CTF1","MLLT1","IL6","ZAK","RAB23","CTDSPL","PFKFB4","ZNF668","PDE5A","HNRNPA0","ANGPTL4","KIAA0146","SEMA3C","GUCY1A2","LRP11","PTPN21","FAT1","TSKU","PCDH19","CREB3L1","EME1","WT1","MORC4","CA12","JPH2","CHID1","JUB","GPC4","DYRK3","DTX4","PARM1","PRPS2","PDXK","CMTM4","GPRC5A","KLF5","CD24" ))
Bladder.srat.combined <- AddModuleScore(Bladder.srat.combined, features = marker_gene_list, name = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score")
FeaturePlot(Bladder.srat.combined, features = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1")

FeaturePlot(Bladder.srat.combined, features = c( "HSP90AA1","HSP90AB1","HSPA1A","HSPA1B" ))
FeaturePlot(Bladder.srat.combined, features = c( "STIP1","FKBP4","FKBP5","PPID" ))
FeaturePlot(Bladder.srat.combined, features = c( "AIP","STUB1","PPP5C","DNAJC7" ))
FeaturePlot(Bladder.srat.combined, features = c( "SUGT1P1","UNC45B","TTC4","TOMM70A" ))
FeaturePlot(Bladder.srat.combined, features = c( "RPAP3","AHSA1","PTGES3","CDC37" ))
FeaturePlot(Bladder.srat.combined, features = c( "CHORDC1","NUDC","YAP1" ))

```

Gene and expression bladder fibroblasts

```{r gene expression Bladder fibroblasts}

DefaultAssay(Bladder.srat.fibroblasts.only) <- "RNA"

marker_gene_list <- list(c( "KRT1","LUM","PHLDA1","C5ORF13","PRRX1","EIF1AX","GPR56","RUNX1","POU2AF1","MOK","HN1","GTPBP8","TARBP1","EREG","SFRP4","COL1A1","CXCL12","MARCKS","COL5A1","FAP","XIST","TGFBI","TCTA","EPHA3","LEF1","SATB1","SATB2","SERPINE1","SERPINE2","CRABP2","TNC","CALML5","CXCL14","LOXL1","FOXO3","SLC5A6","HOXA10","COMP","TRBC1","CDH2","DPYSL3","MYC","SPOCK1","CYP1B1","GRB10","EGR1","CPA3","JAG1","NOP16","SMAD1","IGFBP3","INHBA","AMMECR1","ACLY","SQLE","FOSL1","LOX","SNAI2","IGKV4-1","FBN1","BIRC3","IL7R","INSIG1","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","CNN3","LGALS3","C1QTNF3","NETO2","ANPEP","AMDHD2","HMOX1","SOX9","IER3","EIF5A","MMP2","GGH","MMP3","GFPT2","CFLAR","VEGFC","LIF","TUBB2A","MTSS1","PDZK1IP1","IGLJ3","MFAP5","VCAN","MFAP2","CPE","CD27","TAX1BP3","CD24","ITK","KHDRBS3","COL14A1","TNFAIP6","PEA15","SGPL1","DSE","RRAS2","COL10A1","RRS1","CCR7","MAN1A1","LMCD1","CEP170","DACT1","SERPINB4","IL32","SERPINB3","TMEM176B","ADAM12","BGN","KLF4","ASPN","KLF7","TMEM158","GREM1","FABP5","STK17A","ALDH1A3","LRRC15","IGHM","LRRC17","SEMA3C","THBS1","MSMO1","THBS2","ATP5G1","ROBO1","POLD4","SPTLC2","PTPRZ1","LEPROTL1","COL11A1","AGA","CCL2","ITGAV","CD59","CCL19","EPHB2","CYTH1" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "LJP005_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "LJP005_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "TFAP2B","PDGFRA","PHLDA1","C5ORF13","TLE1","MX1","S100A2","MOK","TM4SF1","SFRP4","IFI44L","SCD","AXL","COL5A1","XIST","SCG2","CNIH4","DEGS1","LEF1","SERPINE1","SERPINE2","TNC","CXCL14","LOXL1","COMP","NT5E","DPYSL3","MYC","SPOCK1","NPTX2","GRB10","PHLDA2","LDLR","FDFT1","IGFBP2","CARD10","JAG1","PMM2","SMAD1","IGFBP3","C13ORF15","INHBA","PRKCA","FOSL1","SLC6A8","EIF5","LOX","MAL","PRPF4","COL6A2","SNAI2","CDC42EP3","TAGLN2","IL7R","SPON1","INSIG1","AK4","PLAU","HIF1A","ELK3","C3","CNN3","RGS3","MICAL2","FAM162A","NKX3-1","KIAA0226L","IER3","FGFBP1","MMP7","JUN","TNFRSF12A","GFPT2","CFLAR","EMP1","APOA2","NRG1","TUBB2A","CDC42BPA","MTSS1","ENAH","PDZK1IP1","MMP10","NFKBIA","VCAN","TF","ARL4C","TUBB2B","ID1","CILP","ITGA6","TAX1BP3","CD24","NVL","REG3A","NID1","AEBP1","TNFAIP2","HK1","UCHL1","COL10A1","LMCD1","PACSIN2","IL32","EGLN3","SPAG4","BGN","SULF1","KLF4","RNASE1","GAL","KLF7","CLEC2B","KLF6","PALLD","ALDH1A3","NDUFA4L2","SPRY4","TRIB2","SRPX","LRRC15","IGHM","ECM1","THBS1","THBS2","COL11A1","BNIP3","CCL2","ITGAV","UPP1","EPHB2" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "LJP009_HA1E_24H-tanespimycin-10_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "LJP009_HA1E_24H-tanespimycin-10_score1")

marker_gene_list <- list(c( "ANXA1","EIF5A","CDKN2A","F2R","AMFR","EIF2S3","COL1A2","BST2","VCAN","COL3A1","GREM1","FABP5","ID3","PLBD1","PFN2","CD24","TLR4","FGFR3","TMEM45A","IL7R","IFITM2","SPARC","NRN1","IFITM3","TYRP1","SATB1","IFITM1","HBB","ADM","KRT23","IFI6","KRT20","THBS2","LOXL2","CTSS","CYR61","HOXA10","ARHGDIA","THBD","UCHL1","ARHGDIB","COL11A1","CD59","CD36" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "LJP006_BT20_3H-geldanamycin-10_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "LJP006_BT20_3H-geldanamycin-10_score1")

marker_gene_list <- list(c( "SLC16A1","PDGFRA","PHLDA1","C5ORF13","TLE1","LMO4","GPR56","MOK","HN1","VCAM1","COL1A1","WT1","CXCL12","BOP1","IGL","AXL","CRISPLD2","COL5A1","FAP","CD9","ITGBL1","CYP1A1","PRSS2","SERPINE1","ODC1","SERPINE2","TNC","LOXL1","HOXA10","EFNB2","COMP","TUBB6","TRBC1","CDH2","DPYSL3","ALOX5","PEG10","MYC","IGKC","TPM1","SPOCK1","CYP1B1","GRB10","ARHGEF40","EGR1","CPA3","POSTN","JAG1","EGR3","IGFBP3","INHBA","IGF1","MINA","MAFB","CKAP4","ACLY","SQLE","FOSL1","CREB1","EIF5","COL6A1","LOX","COL6A2","SPATS2L","SNAI2","FBN1","CFD","SPON2","ATP6V1D","INSIG1","PDGFC","GATA6","AK4","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","LIPA","C3","LGALS3","C1QTNF3","C7","ANPEP","AMDHD2","PMEPA1","TSPAN7","HMOX1","TPSAB1","IER3","MMP2","GGH","GFPT2","CFLAR","EMP1","VEGFC","FN1","LIF","TUBB2A","MTSS1","MFAP5","VCAN","RAP2B","MEIS1","MFAP4","ALB","BHLHE40","CILP","FXYD2","TAX1BP3","COL14A1","TNFAIP8","THY1","CLEC7A","TIMP3","RRS1","LMCD1","PCK2","DACT1","TIMM8B","SERPINB2","IL32","ADAM12","QPCT","AKR1C3","LSS","KLF2","ASPN","KLF7","TMEM158","CLEC2B","FABP5","RPIA","ALDH1A3","MAP1B","VDAC1","CD44","SRPX","LRRC15","IGHM","LRRC17","F13A1","AMIGO2","SEMA3C","THBS1","AFP","SRM","THBS2","POLD4","AKAP12","ADAMTS1","PNMA1","NEFL","CCL2","ITGAV","EPHB2","CYTH1" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "LJP006_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "LJP006_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "COL11A1","ZNF469","SULF1","FAP","KIF26B","MMP11","NOX4","COL5A2","GRP","COL10A1","TBC1D8B","CTSK","TBX15","COMP","FNDC1","RASAL2","HEYL","WISP1","COL8A1","ANTXR1","CNIH3","OLFML2B","CMTM8","LAYN","THBS2","ZNF587","IL13RA1","SIRPA","FKBP9","FGF18","ANGPT2","NOTCH4","GZMB","CHSY1","MMP7","RNF149","LOXL1","MRPS10","LAMP1","FBN1","MYH9","EXOC5","MORC4","IFITM1","CD93","PNPO","APBB2","PCDH17","KCNQ1","EGFL6","CDS2","SULF2","AMDHD2","ITPK1","CTDSP2","ARF4","GALNT10","SOCS3","IGFBP7","FBXO22","LRRC32","BCL2L1","ADAM12","ARL8A","MAML1","ADAMTS2","ITGA11","ELMOD2","HSD3B7","CECR5","TMEM109","DNAJB2","SPIN3","JUNB","GALNT1","RAI1","EHMT1","WSB2","AEBP1","ARMCX5","SPARC","INHBA","EVC","MAPRE1","CD248","BPGM","PPAPDC1A","C2","STARD3NL","ALDH1A3","PCBD1","CTHRC1","PDPN","ATP2A2","CYFIP1","DDAH2","TMEM30A","PQLC3","PCDHB10","HSPH1","PCID2","KAL1","LAMP2","RNF187","CCDC92","KRT23","NCK2","RAB15","BMP1","TNFSF4","CXCL2","PTPN12","CMTM4","ZNF668","SEPT8","ADAMTS6","QDPR","C1QTNF6","OSM","MYH10","SUMF1","IMPACT","GLB1","EDNRA","ANKH","CNP","B3GALT6","DYNLT1","MMP16","CD3EAP","SFXN3","RAB18","ABL2","DKK2","ELMO2","FZD8","LRRC15","PTP4A3","IFITM3","SEMA5A","ATP6V1C1","PPEF1","TRAM1","DDB1","FOLH1","BICC1","ADAMTS12","GLMP","TGFBRAP1","MFAP2","TMEM132A","C8orf34","FBXL20","GOLGA5","NECAP2","EFNB2","BAP1","IFITM2","BZW2","CXCL10","PTPLAD1","ISLR","GNB1","SCYL2","RAB40C","GJA5","SPOUT1","FASTKD2","PEX7","DEXI","MYB","GTF3C1","CD82","DIAPH3","ABHD11","UBAP2","KDR","HOXB8","KIF9","EFEMP2","XPO4","CLTC","DIABLO","CALU","ZNF282","TRIM29","CXCL6","CSNK1G3","VPS41","TMCO3","EPHB2","STARD4","PTPRG","TRIM68","EXOSC4","POLE3","PRPF4","SOX9","NEK1","FJX1","CACNA1D","HECW2","ADCK2","SLC12A8","DUSP14","JAG2","PIGW","TMED1" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "STROMA hi BC OV CR_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "STROMA hi BC OV CR_score1")

gene_list_too_long_1 <- c( "FGF2","PKP1","INHBA","JUP","ADCY7","SLC20A1","ENDOD1","TUBB3","HBEGF","NES","SEMA7A","WHRN","TNNT2","CNNM4","ITGB3","TRIM66","HR","MEGF10","OLR1","LRRC8C","ARL4C","CMKLR1","NIPAL1","LAD1","DUSP6","MED14","THBS1","WNT5A","PMAIP1","KCTD11","NUAK2","ZC3H12C","COQ10B","MN1","TBX3","SKIL","CTDP1","BHLHE40","ZSWIM6","WNT11","RAP1GAP2","PIEZO2","PMEPA1","VEGFA","TNFRSF21","IRAK2","MYO1E","CARD10","IGF2BP3","MAP6","SEC14L2","RYBP","LRRC8B","GREM2","SMAD7","TMCC2","PCDH7","ASAP2","ITGA5","COTL1","DZIP1L","LAMB3","TTC39B","GPR39","SCHIP1","PLAU","PHTF2","PTGS1","DENR","GDPD5","PPP1R13L","HOMER1","MOB3B","VOPP1","RDH10","FKBP5","F2R","MICAL2","YWHAQ","CNTN2","BLCAP","OTUD4","KANSL3","PIP4K2A","PLAUR","RASA1","SLC7A1","POLR3D","ZFPM1","ARPC2","LRRC15","NRIP1","IGSF3","PKIA","NIN","ACOT7","IVNS1ABP","PRG4","SLC25A30","ABRACL","ANO1","OSGIN2","ARID5A","RUNX1","TGIF1","CBLB","TUBA1A","NAV1","PRKG2","COL5A3","LRRC75A","KIAA1671","ARNT2","TNS3","CAMSAP2","ZNF451","RNF19B","MTFR1","AP1S3","SMOC1","PHYHIPL","CHST11","ANTXR2","GPR161","MLLT11","ADCY1","RGS20","SYT11","TAGLN","AGO2","SPSB1","SORCS2","CNN3","NNT","DOCK8","PLAGL1","SEPT11","DGCR8","NCOR2","ZMIZ1","AHCY","SH3BGRL2","LARP1B","RAB31","GOLM1","ZYX","KLHDC8A","CSNK1E","FOXN2","SMURF2","ACSL6","SOCS2","TMSB10","DDAH1","EVA1A","ALCAM","RELT","ARHGEF5","PSTPIP2","EGR2","FOXP4","B4GALNT1","FBLIM1","ADNP","ANGPTL4","PIK3C2B","RRN3","DBN1","ANKRD1","ZBED4","ADRM1","WNT7B","KPNA4","CTSF","HOMER3","PLEKHG3","RBMS1","CDR2","UTP18","BOK","TMEFF1","CYTH4","RTN2","PIM1","HES1","NFKB1","TATDN2","BPIFC","LMCD1","DPYSL3","TNS1","UCN2","AGAP1","L3MBTL3","SMIM15","BRD1","RRS1","SYDE2","GLI3","LTV1","UTRN","CTSW","CD200","MAST4","IL11","PRR5","MYH9","ZNF266","KCNN3","B3GNT2","UBXN2A","DDAH2","CCDC97","NEDD9","LUZP1","PFKFB4","EAF1","IDH3A","LIN7C","NFATC1","SMTN","RNF4","C1QL1","FUBP1","SNAI1","ANKH","MAFF","PTPN12","FASTKD5","SLC39A6","PHLDB2","TES","HACE1","MYO19","IL34","FBXO30","TIMP1","EIF4G2","TMEM200A","CDYL2","ATP2B4","HMCN2","JADE1","PRDM1","SSR3","CDV3","STARD10","ARIH1","CCDC34","CHD1","WNT9A","PDZD8","MYO1D","FES","GABPB1","KCNH1","CRLF1","DNAJC21","ACTG1","RDH8","TPM3","TANC1","FBXL16","FERMT2","E2F3","LITAF","SUCO","USP34","TAGLN2","LYSMD3","PAK4","NOP58","MPHOSPH6","CDC42SE2","GRK6","RNF6","HSPA4","DNAJA4","UBE2J1","ERCC1","KPNA1","ATP1A3","CDC73","VASH1","MAFG","FOXP1","PDLIM7","CDK12","GLCE","ATG9B","CXorf38","CSRP1","RAP1GAP","ACTB","ZNF362","TAB3","GK5","SEMA6A","ZNF518A","ELAVL1","RAB6A","MSN","YLPM1","MTMR7","GABBR1","FRK","SMAD2","IRS2","NAPG","FPGT","ATF4","M6PR","IRF2BPL","AKIRIN1","KCTD15","TMEM168","PARD3","TPD52","TEC","CCDC112","COL27A1","LIMD1","ARMC5","FAM156B","FAM156A","FYN","RAPH1","OSBPL6","PHF2","PPHLN1","KCNK12","IER2","DHX33","SPRED1","RAB11FIP3","NMD3","LDLRAD4","DLG3","GJA4","USP39","CACNA1I","CHML","ZNF821","WDFY3","FURIN","CHD5","LRP5","SHROOM3","MCF2L","SWAP70","EPC2","UBE2F","NCOA6","PPP3R1" )
gene_list_too_long_2 <- c( "PRKRIP1","PTGFRN","TUFT1","UNC45A","TYW5","PREP","CSK","CRABP1","TPM4","GPATCH11","UCHL1","ITGB1","KLC2","IL17RD","SAP30BP","SBK1","TRIM46","NPLOC4","APPL1","ARFGEF1","MYO10","PLK3","NPPB","XPOT","ZFP64","STK39","SYN1","MAP4K4","ZFYVE9","ARMCX2","RHEB","CCAR1","PRSS22","PTAR1","KBTBD2","HSBP1L1","ACTR2","TRIM33","PNO1","SYT6","HSPA13","UBTD1","TAB2","ESF1","FZD2","CHRNB1","LEF1","VPS37A","GCNT2","SS18","SYNJ2","TMEM132A","CALCRL","ZZZ3","TMSB4Y","LATS1","FAM104B","RNF121","PITPNB","PTPRN","GLI1","TMEM39B","CAMSAP1","ZNRF2","PLAA","PTGES3","PXDN","ELL2","MOB4","EXOC5","PDCL","BZW1","TMEM47","ZNF274","NBN","PAPOLA","TMEM158","SMC5","PDZRN3","AK1","TRRAP","WASL","SERP1","NCOA7","ZNF322","TSG101","PRMT5","USP10","PTPN21","RASSF8","DYRK2","FOXJ3","SENP6","PPARGC1B","ACTA1","LSM14B","UBQLN2","ARID3A","PSMC6","CAB39","MTX3","RBBP5","GPER1","ITFG2","KCTD3","UBE2J2","TNK2","WWP1","ANXA8L1","ANXA8","LPIN3","CSRNP2","MALT1","LRRC47","PPRC1","RIOK2","PCGF3","RAD54L2","XPO4","ATP2A2","EVI5","ADCYAP1R1","ZFP91","HK2","SSX2IP","TRIM27","MYADM","GOLIM4","GRHL2","DCUN1D1","SRI","CLTC","TRIP10","ZNF148","SMAD1","UBFD1","CCDC24","EIF1AD","PFN1","PFKP","JMJD6","RAI14","NUP153","MTHFD2","EFNB1","GPBP1L1","AOC2","EXT1","PDCL3","TNFAIP6","MRPL20","EHBP1L1","INO80E","RNF8","THAP1", "ZC3H15","EEF1E1","REPS1","GAD1","CNOT7","RASA3","TWF1","AP1G1","PEPD","WRNIP1","MAML1","TNC","SMARCE1","RAB11B","CEBPA","RIPK1","CHSY1","INIP","GNB1","R3HCC1","EFNB2","ARHGEF40","BAG2","GDPD1","PLS3","MTERF3","PIGG","SMARCD1","NPAS4","USP9X","ATXN2L","ARFIP1","SHROOM2","FBXO21","GLIS2","CEMIP","TTC33","GSTO1","ARID1A","SAMD14","YAF2","TXNDC17","SEMA4C","ATN1","CRCP","HYOU1","TMBIM1","PYGO2","LYSMD2","FLRT2","MSL1","BDH1","KCNN4","NHLRC2","PHLDA3","EIF2S1","ARHGAP32","PHYHIP","TRIM9","CGN","BMPR2","YWHAG","KCMF1","PLP2","PLEKHA5","SP4","MCAM","ESYT2","TBX18","PPM1B","KALRN","ANKRA2","CXADR")
gene_list_too_long_3 <- c( "LMAN1L","WDR45B","NAA15","NOL4L","LOXL2","ANXA6","TRIM36","NOL10","TNPO3","UBE2D1","ANKRD11","UBE2K","OLFM2","POLR2C","RFXANK","RABEP2","IFRD1","EXOC1","NAP1L4","SERPINE1","RABGEF1","POLR3B","GAR1","TJP1","OSBPL3","RAB11FIP4","SSBP1","IPPK","FAM118B","DDX31","KLC1","SPSB4","ZNF236","SRP9","PTGS2","TP53BP2","EPHA3","RPF1","PDE4D","WNT1","FAM118A","SMIM14","ZDHHC5","FEZ2","FSTL3","ABR","FZD6","DAD1","TSPYL2","RALA","CD24","DVL3","NPR3","CSNK1G1","TRAPPC13","GPSM1","ALKBH8","CRISPLD2","ACTN1","ACTR1B","RAB11FIP1","SEC24B","KLF11","NOL4","BCL7A","HTATSF1","BRWD1","GTPBP4","SCAF4","RUFY1","FNBP1L","FIZ1","C1GALT1","ARHGDIA","RAP2A","SCAMP5","TMOD2","KRT79","PHF10","USP7","PRPF39","SLC35E4","JUNB","STX6","ZNF207","NRBP1","GTF3C4","GATA2","DNAJB12","MAGOH","ZBTB1","PITHD1","RPS6KA2","SHMT2","RASL12","CUL1","YTHDF2","POGZ","CYP51A1","SBDS","USP31","AMMECR1L","CTNNA1","POLB","DDX21","LRRC8A","HNRNPCL1","HNRNPCL4","HNRNPCL2","HNRNPCL3","RASSF3","MORC2","TBC1D1","CTTNBP2NL","CDC14B","CDC14C","NOVA1","GATA3","SKI","DNAJC11","METAP1","DHX15","EFNA1","HAVCR2","EIF2S2","UBE2N","RAD17","SYNGR3","CEBPB","DDX18","SPRY4","SPATA5","TTC19","MYL9","BRIX1","NCBP1","FUBP3","CCSAP","MYLK2","TAF9","SAFB","GAB2","WDR74","CREB3L1","BZW2","PHF20L1","RC3H1","RNF122","BAZ1A","PUF60","NUP54","GP1BB","KAT5","WASF1","RAB39B","NTAQ1","FBXO22","CCDC86","INTS12","PTCH2","BMS1","ATG16L1","BBS12","EIF1B","AMOTL2","ZNF878","PLOD2","PACS1","PTBP2","TFG","ZNF532","RBM6","SLC4A7","PITPNC1","BYSL","E2F6","PHF14","VEGFC","AMOT","PHF12","CYP26B1","WDR1","UAP1","DMTF1","TPR","HRH1","ABCE1","LDB1","SNAPC3","LSP1","IBTK","ZNF592","DOT1L","ARL13B","NUDT15","APCDD1","SUPT16H","PRRC1","LAS1L","YWHAH","MANF","SPRYD7","CPSF7","IL1A","ATP9A","ZMAT3","SEMA4D","CASP8","ZNF142","ARF4","E2F4","INTS7","RSF1","CLU","ZBTB44","CCT2","GZMM","CUL3","CYTH2","GCNT1","STRBP","PRSS23","STRN3","SF3B1","CEP85","INO80","ATAD2B","ZFP57","CD1D","NAF1","DCUN1D5","PABPN1","PIN1","CRIP2","JAG1","ITCH","ITSN1","PPAN","DR1","RHBDF1","AKAP11","GADD45A","OTUD6B","AVPI1","MAPKBP1","RFTN2","IMP4","CLSTN1","USO1","RTKN","BRPF1","STX7","ERP44","PPID","DHX38","ERC1","PHLPP1","TMEM245","CFI","TMEM201","CDIPT","SMCO4","ORC4","ZFR","DNAJC1","CAMK2N1","RBBP6","TCF4","TIRAP","FHL3","STAU2","PXDC1","COL17A1","BMPR1B","C15orf39","WDR47","ADRA2A","MICAL1" )
gene_list_too_long_4 <- c( "MORC4","SDCBP2","ZNF250","SPATA13","KCTD12","FLNA","SHF","ZDHHC16","SUPT20H","NF2","SLC22A4","MYH10","THUMPD1","ZCCHC9","TMEM151A","PCDH1","MIEF1","BUD31","TRIM29","TAF15","SLC25A25","TLE3","BRD4","TIPRL","CHORDC1","IL2RB","NCOA3","RHNO1","FCER1G","ARRB2","CEP104","CSNK2A2","CDYL","MICAL3","CALM1","CALM3","CALM2","CCDC102A","FAM219A","GTF2A1","C18orf21","KCNG1","SOCS5","GOLPH3","FPGS","EDRF1","MRPL16","MLLT1","TNFRSF4","NR2C2AP","WDR75","TIMM23","PTHLH","PQBP1","ACIN1","DDX54","RSL1D1","KLF10","LYN","PTPN9","TNS2","CACNA2D1","GPRIN1","DAZAP2","CABP1","TMEM33","ZMYM4","PRPF3","DROSHA","ITGB1BP2","AKTIP","SH3BP2","HNRNPL","ADIPOR2","SAFB2","NANS","SNX7","DDHD1","ZNF800","RAB21","FUS","ZNF827","ZBTB47","HOXA3","ISL2","RBM25","RSL24D1","CBX1","UCK1","ADAMTS4","MAFA","GORASP2","EIF3A","PSMD7","TMX1","RNF19A","SAP25","PRX","ADAMTSL3","SMYD5","RANBP2","USF2","PAFAH1B1","FBN1","RBSN","ENY2","RAB3C","ADGRG5","TMEM11","CLIP2","STAM","TBXT","OTUD7B","GTF2E1","PLRG1","CBFB","TMEM59L","OSBPL11","OSBP2","POLR2H","CEP170","GPN2","FCRLB","PFDN1","SMAD4","PPP2R2A","DDX5","NRARP","RNF103","PRPF4B","ACSL4","IARS1","SGTB","FBXO11","WDR4","DDX52","GGNBP2","MAPKAPK2","CUL5","SRP54","RGS16","SNX11","F2RL2","CFAP20","ACBD3","NT5E","ZNF778","ZNF487","PDE12","PELP1","PPP1R15A","GRB2","HAS1","SLCO5A1","GLS2","CKB","TMED2","ADGRL3","B4GALT1","KLRB1","LIMK1","GTF3C3","ACSL3","HIF1AN","IL6","ZDHHC20","SLMAP","AIF1L","CCDC88A","MED7","ARID4A","KIAA1328","EIF3J","PFDN4","KLHL30","UTP6","RAB23","RICTOR","YARS2","TAF13","PCMTD1","KCNH5","TAF3","DAB2IP","DSTN","SNIP1","CCDC59","MDM2","RSRC2","ESRRA","PTK2B","FGL2","UNC5B","DDX46","THOC7","AAK1","ACTG2","TARS1","PLEKHB1","MPHOSPH10","TRA2B","GARS1","CKAP4","C4orf3","EIF4ENIF1","SP3","PDCD10","MPLKIP","POGK","TCEAL8","AMPD2","NAT14","NFXL1","HDAC7","PRDM10","BAMBI","SMOC2","CGGBP1","RUFY3","RAB2A","LGR6","KLHL11","SART1","BCLAF1","PGBD5","PAWR","SIN3B","DPP9","PKP3","MMP17","CREB1","SH2B1","FBXW11","NOP14","PRCC","TMEM81","TOMM34","DDX47","BPTF","ETS2","BATF3","ASTE1","GPT2","ZBTB21" )
marker_gene_list <- list(c( gene_list_too_long_1 , gene_list_too_long_2, gene_list_too_long_3, gene_list_too_long_4 ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "CAF NOT mNF+T HSP90A specific genes_UP_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "CAF NOT mNF+T HSP90A specific genes_UP_score1")

marker_gene_list <- list(c( "FHL1","BASP1","AXL","FBLN1","CTGF","TIMP3","CCL2","COL8A1","FIBIN","EFEMP2","LHFP","PLAU","NDN","SLC24A3","RGS16","COL11A1","INHBA","F3","TNFAIP6","FRZB","NDE1","S1PR3","WNT2B","CXCL1","SVEP1","KDELR3","FBLN5","SYDE1","SEPT11","MARCKS","CHN1","ZMAT3","AKAP12","LMO4","AKR1B1","PPP1R14A","NOTCH2","ADAMTSL4","TPM1","WISP1","CRMP1","GPR176","DCBLD2","TPBG","PELO","ADM","CXCL10","GXYLT2","ERRFI1","ANTXR2","APCDD1","GPX7","MAN1C1","PARVA","STEAP2","SMARCA1","ACTG2","STEAP1","YAP1","RNF144A","SMTN","FHL2","MOXD1","NEXN","FARP1","C2CD2","CYP1B1","FST","LCAT","MICALL2","TEAD1","EPHA3","PDLIM2","MEST","WBSCR17","KIAA1199","HSPA12A","NUCKS1","KIAA1211","HAS2","NCS1","NEK6","SSR1","UCN2","SGMS2","CTF1","MLLT1","IL6","ZAK","RAB23","CTDSPL","PFKFB4","ZNF668","PDE5A","HNRNPA0","ANGPTL4","KIAA0146","SEMA3C","GUCY1A2","LRP11","PTPN21","FAT1","TSKU","PCDH19","CREB3L1","EME1","WT1","MORC4","CA12","JPH2","CHID1","JUB","GPC4","DYRK3","DTX4","PARM1","PRPS2","PDXK","CMTM4","GPRC5A","KLF5","CD24" ))
Bladder.srat.fibroblasts.only <- AddModuleScore(Bladder.srat.fibroblasts.only, features = marker_gene_list, name = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score")
FeaturePlot(Bladder.srat.fibroblasts.only, features = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1")

FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "HSP90AA1","HSP90AB1","HSPA1A","HSPA1B" ))
FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "STIP1","FKBP4","FKBP5","PPID" ))
FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "AIP","STUB1","PPP5C","DNAJC7" ))
FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "SUGT1P1","UNC45B","TTC4","TOMM70A" ))
FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "RPAP3","AHSA1","PTGES3","CDC37" ))
FeaturePlot(Bladder.srat.fibroblasts.only, features = c( "CHORDC1","NUDC","YAP1" ))

```

Gene and expression breast

```{r gene expression Breast}

DefaultAssay(Breast.srat.combined) <- "SCT"

marker_gene_list <- list(c( "KRT1","LUM","PHLDA1","C5ORF13","PRRX1","EIF1AX","GPR56","RUNX1","POU2AF1","MOK","HN1","GTPBP8","TARBP1","EREG","SFRP4","COL1A1","CXCL12","MARCKS","COL5A1","FAP","XIST","TGFBI","TCTA","EPHA3","LEF1","SATB1","SATB2","SERPINE1","SERPINE2","CRABP2","TNC","CALML5","CXCL14","LOXL1","FOXO3","SLC5A6","HOXA10","COMP","TRBC1","CDH2","DPYSL3","MYC","SPOCK1","CYP1B1","GRB10","EGR1","CPA3","JAG1","NOP16","SMAD1","IGFBP3","INHBA","AMMECR1","ACLY","SQLE","FOSL1","LOX","SNAI2","IGKV4-1","FBN1","BIRC3","IL7R","INSIG1","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","CNN3","LGALS3","C1QTNF3","NETO2","ANPEP","AMDHD2","HMOX1","SOX9","IER3","EIF5A","MMP2","GGH","MMP3","GFPT2","CFLAR","VEGFC","LIF","TUBB2A","MTSS1","PDZK1IP1","IGLJ3","MFAP5","VCAN","MFAP2","CPE","CD27","TAX1BP3","CD24","ITK","KHDRBS3","COL14A1","TNFAIP6","PEA15","SGPL1","DSE","RRAS2","COL10A1","RRS1","CCR7","MAN1A1","LMCD1","CEP170","DACT1","SERPINB4","IL32","SERPINB3","TMEM176B","ADAM12","BGN","KLF4","ASPN","KLF7","TMEM158","GREM1","FABP5","STK17A","ALDH1A3","LRRC15","IGHM","LRRC17","SEMA3C","THBS1","MSMO1","THBS2","ATP5G1","ROBO1","POLD4","SPTLC2","PTPRZ1","LEPROTL1","COL11A1","AGA","CCL2","ITGAV","CD59","CCL19","EPHB2","CYTH1" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "LJP005_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Breast.srat.combined, features = "LJP005_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "TFAP2B","PDGFRA","PHLDA1","C5ORF13","TLE1","MX1","S100A2","MOK","TM4SF1","SFRP4","IFI44L","SCD","AXL","COL5A1","XIST","SCG2","CNIH4","DEGS1","LEF1","SERPINE1","SERPINE2","TNC","CXCL14","LOXL1","COMP","NT5E","DPYSL3","MYC","SPOCK1","NPTX2","GRB10","PHLDA2","LDLR","FDFT1","IGFBP2","CARD10","JAG1","PMM2","SMAD1","IGFBP3","C13ORF15","INHBA","PRKCA","FOSL1","SLC6A8","EIF5","LOX","MAL","PRPF4","COL6A2","SNAI2","CDC42EP3","TAGLN2","IL7R","SPON1","INSIG1","AK4","PLAU","HIF1A","ELK3","C3","CNN3","RGS3","MICAL2","FAM162A","NKX3-1","KIAA0226L","IER3","FGFBP1","MMP7","JUN","TNFRSF12A","GFPT2","CFLAR","EMP1","APOA2","NRG1","TUBB2A","CDC42BPA","MTSS1","ENAH","PDZK1IP1","MMP10","NFKBIA","VCAN","TF","ARL4C","TUBB2B","ID1","CILP","ITGA6","TAX1BP3","CD24","NVL","REG3A","NID1","AEBP1","TNFAIP2","HK1","UCHL1","COL10A1","LMCD1","PACSIN2","IL32","EGLN3","SPAG4","BGN","SULF1","KLF4","RNASE1","GAL","KLF7","CLEC2B","KLF6","PALLD","ALDH1A3","NDUFA4L2","SPRY4","TRIB2","SRPX","LRRC15","IGHM","ECM1","THBS1","THBS2","COL11A1","BNIP3","CCL2","ITGAV","UPP1","EPHB2" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "LJP009_HA1E_24H-tanespimycin-10_score")
FeaturePlot(Breast.srat.combined, features = "LJP009_HA1E_24H-tanespimycin-10_score1")

marker_gene_list <- list(c( "ANXA1","EIF5A","CDKN2A","F2R","AMFR","EIF2S3","COL1A2","BST2","VCAN","COL3A1","GREM1","FABP5","ID3","PLBD1","PFN2","CD24","TLR4","FGFR3","TMEM45A","IL7R","IFITM2","SPARC","NRN1","IFITM3","TYRP1","SATB1","IFITM1","HBB","ADM","KRT23","IFI6","KRT20","THBS2","LOXL2","CTSS","CYR61","HOXA10","ARHGDIA","THBD","UCHL1","ARHGDIB","COL11A1","CD59","CD36" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "LJP006_BT20_3H-geldanamycin-10_score")
FeaturePlot(Breast.srat.combined, features = "LJP006_BT20_3H-geldanamycin-10_score1")

marker_gene_list <- list(c( "SLC16A1","PDGFRA","PHLDA1","C5ORF13","TLE1","LMO4","GPR56","MOK","HN1","VCAM1","COL1A1","WT1","CXCL12","BOP1","IGL","AXL","CRISPLD2","COL5A1","FAP","CD9","ITGBL1","CYP1A1","PRSS2","SERPINE1","ODC1","SERPINE2","TNC","LOXL1","HOXA10","EFNB2","COMP","TUBB6","TRBC1","CDH2","DPYSL3","ALOX5","PEG10","MYC","IGKC","TPM1","SPOCK1","CYP1B1","GRB10","ARHGEF40","EGR1","CPA3","POSTN","JAG1","EGR3","IGFBP3","INHBA","IGF1","MINA","MAFB","CKAP4","ACLY","SQLE","FOSL1","CREB1","EIF5","COL6A1","LOX","COL6A2","SPATS2L","SNAI2","FBN1","CFD","SPON2","ATP6V1D","INSIG1","PDGFC","GATA6","AK4","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","LIPA","C3","LGALS3","C1QTNF3","C7","ANPEP","AMDHD2","PMEPA1","TSPAN7","HMOX1","TPSAB1","IER3","MMP2","GGH","GFPT2","CFLAR","EMP1","VEGFC","FN1","LIF","TUBB2A","MTSS1","MFAP5","VCAN","RAP2B","MEIS1","MFAP4","ALB","BHLHE40","CILP","FXYD2","TAX1BP3","COL14A1","TNFAIP8","THY1","CLEC7A","TIMP3","RRS1","LMCD1","PCK2","DACT1","TIMM8B","SERPINB2","IL32","ADAM12","QPCT","AKR1C3","LSS","KLF2","ASPN","KLF7","TMEM158","CLEC2B","FABP5","RPIA","ALDH1A3","MAP1B","VDAC1","CD44","SRPX","LRRC15","IGHM","LRRC17","F13A1","AMIGO2","SEMA3C","THBS1","AFP","SRM","THBS2","POLD4","AKAP12","ADAMTS1","PNMA1","NEFL","CCL2","ITGAV","EPHB2","CYTH1" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "LJP006_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Breast.srat.combined, features = "LJP006_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "COL11A1","ZNF469","SULF1","FAP","KIF26B","MMP11","NOX4","COL5A2","GRP","COL10A1","TBC1D8B","CTSK","TBX15","COMP","FNDC1","RASAL2","HEYL","WISP1","COL8A1","ANTXR1","CNIH3","OLFML2B","CMTM8","LAYN","THBS2","ZNF587","IL13RA1","SIRPA","FKBP9","FGF18","ANGPT2","NOTCH4","GZMB","CHSY1","MMP7","RNF149","LOXL1","MRPS10","LAMP1","FBN1","MYH9","EXOC5","MORC4","IFITM1","CD93","PNPO","APBB2","PCDH17","KCNQ1","EGFL6","CDS2","SULF2","AMDHD2","ITPK1","CTDSP2","ARF4","GALNT10","SOCS3","IGFBP7","FBXO22","LRRC32","BCL2L1","ADAM12","ARL8A","MAML1","ADAMTS2","ITGA11","ELMOD2","HSD3B7","CECR5","TMEM109","DNAJB2","SPIN3","JUNB","GALNT1","RAI1","EHMT1","WSB2","AEBP1","ARMCX5","SPARC","INHBA","EVC","MAPRE1","CD248","BPGM","PPAPDC1A","C2","STARD3NL","ALDH1A3","PCBD1","CTHRC1","PDPN","ATP2A2","CYFIP1","DDAH2","TMEM30A","PQLC3","PCDHB10","HSPH1","PCID2","KAL1","LAMP2","RNF187","CCDC92","KRT23","NCK2","RAB15","BMP1","TNFSF4","CXCL2","PTPN12","CMTM4","ZNF668","SEPT8","ADAMTS6","QDPR","C1QTNF6","OSM","MYH10","SUMF1","IMPACT","GLB1","EDNRA","ANKH","CNP","B3GALT6","DYNLT1","MMP16","CD3EAP","SFXN3","RAB18","ABL2","DKK2","ELMO2","FZD8","LRRC15","PTP4A3","IFITM3","SEMA5A","ATP6V1C1","PPEF1","TRAM1","DDB1","FOLH1","BICC1","ADAMTS12","GLMP","TGFBRAP1","MFAP2","TMEM132A","C8orf34","FBXL20","GOLGA5","NECAP2","EFNB2","BAP1","IFITM2","BZW2","CXCL10","PTPLAD1","ISLR","GNB1","SCYL2","RAB40C","GJA5","SPOUT1","FASTKD2","PEX7","DEXI","MYB","GTF3C1","CD82","DIAPH3","ABHD11","UBAP2","KDR","HOXB8","KIF9","EFEMP2","XPO4","CLTC","DIABLO","CALU","ZNF282","TRIM29","CXCL6","CSNK1G3","VPS41","TMCO3","EPHB2","STARD4","PTPRG","TRIM68","EXOSC4","POLE3","PRPF4","SOX9","NEK1","FJX1","CACNA1D","HECW2","ADCK2","SLC12A8","DUSP14","JAG2","PIGW","TMED1" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "STROMA hi BC OV CR_score")
FeaturePlot(Breast.srat.combined, features = "STROMA hi BC OV CR_score1")

gene_list_too_long_1 <- c( "FGF2","PKP1","INHBA","JUP","ADCY7","SLC20A1","ENDOD1","TUBB3","HBEGF","NES","SEMA7A","WHRN","TNNT2","CNNM4","ITGB3","TRIM66","HR","MEGF10","OLR1","LRRC8C","ARL4C","CMKLR1","NIPAL1","LAD1","DUSP6","MED14","THBS1","WNT5A","PMAIP1","KCTD11","NUAK2","ZC3H12C","COQ10B","MN1","TBX3","SKIL","CTDP1","BHLHE40","ZSWIM6","WNT11","RAP1GAP2","PIEZO2","PMEPA1","VEGFA","TNFRSF21","IRAK2","MYO1E","CARD10","IGF2BP3","MAP6","SEC14L2","RYBP","LRRC8B","GREM2","SMAD7","TMCC2","PCDH7","ASAP2","ITGA5","COTL1","DZIP1L","LAMB3","TTC39B","GPR39","SCHIP1","PLAU","PHTF2","PTGS1","DENR","GDPD5","PPP1R13L","HOMER1","MOB3B","VOPP1","RDH10","FKBP5","F2R","MICAL2","YWHAQ","CNTN2","BLCAP","OTUD4","KANSL3","PIP4K2A","PLAUR","RASA1","SLC7A1","POLR3D","ZFPM1","ARPC2","LRRC15","NRIP1","IGSF3","PKIA","NIN","ACOT7","IVNS1ABP","PRG4","SLC25A30","ABRACL","ANO1","OSGIN2","ARID5A","RUNX1","TGIF1","CBLB","TUBA1A","NAV1","PRKG2","COL5A3","LRRC75A","KIAA1671","ARNT2","TNS3","CAMSAP2","ZNF451","RNF19B","MTFR1","AP1S3","SMOC1","PHYHIPL","CHST11","ANTXR2","GPR161","MLLT11","ADCY1","RGS20","SYT11","TAGLN","AGO2","SPSB1","SORCS2","CNN3","NNT","DOCK8","PLAGL1","SEPT11","DGCR8","NCOR2","ZMIZ1","AHCY","SH3BGRL2","LARP1B","RAB31","GOLM1","ZYX","KLHDC8A","CSNK1E","FOXN2","SMURF2","ACSL6","SOCS2","TMSB10","DDAH1","EVA1A","ALCAM","RELT","ARHGEF5","PSTPIP2","EGR2","FOXP4","B4GALNT1","FBLIM1","ADNP","ANGPTL4","PIK3C2B","RRN3","DBN1","ANKRD1","ZBED4","ADRM1","WNT7B","KPNA4","CTSF","HOMER3","PLEKHG3","RBMS1","CDR2","UTP18","BOK","TMEFF1","CYTH4","RTN2","PIM1","HES1","NFKB1","TATDN2","BPIFC","LMCD1","DPYSL3","TNS1","UCN2","AGAP1","L3MBTL3","SMIM15","BRD1","RRS1","SYDE2","GLI3","LTV1","UTRN","CTSW","CD200","MAST4","IL11","PRR5","MYH9","ZNF266","KCNN3","B3GNT2","UBXN2A","DDAH2","CCDC97","NEDD9","LUZP1","PFKFB4","EAF1","IDH3A","LIN7C","NFATC1","SMTN","RNF4","C1QL1","FUBP1","SNAI1","ANKH","MAFF","PTPN12","FASTKD5","SLC39A6","PHLDB2","TES","HACE1","MYO19","IL34","FBXO30","TIMP1","EIF4G2","TMEM200A","CDYL2","ATP2B4","HMCN2","JADE1","PRDM1","SSR3","CDV3","STARD10","ARIH1","CCDC34","CHD1","WNT9A","PDZD8","MYO1D","FES","GABPB1","KCNH1","CRLF1","DNAJC21","ACTG1","RDH8","TPM3","TANC1","FBXL16","FERMT2","E2F3","LITAF","SUCO","USP34","TAGLN2","LYSMD3","PAK4","NOP58","MPHOSPH6","CDC42SE2","GRK6","RNF6","HSPA4","DNAJA4","UBE2J1","ERCC1","KPNA1","ATP1A3","CDC73","VASH1","MAFG","FOXP1","PDLIM7","CDK12","GLCE","ATG9B","CXorf38","CSRP1","RAP1GAP","ACTB","ZNF362","TAB3","GK5","SEMA6A","ZNF518A","ELAVL1","RAB6A","MSN","YLPM1","MTMR7","GABBR1","FRK","SMAD2","IRS2","NAPG","FPGT","ATF4","M6PR","IRF2BPL","AKIRIN1","KCTD15","TMEM168","PARD3","TPD52","TEC","CCDC112","COL27A1","LIMD1","ARMC5","FAM156B","FAM156A","FYN","RAPH1","OSBPL6","PHF2","PPHLN1","KCNK12","IER2","DHX33","SPRED1","RAB11FIP3","NMD3","LDLRAD4","DLG3","GJA4","USP39","CACNA1I","CHML","ZNF821","WDFY3","FURIN","CHD5","LRP5","SHROOM3","MCF2L","SWAP70","EPC2","UBE2F","NCOA6","PPP3R1" )
gene_list_too_long_2 <- c( "PRKRIP1","PTGFRN","TUFT1","UNC45A","TYW5","PREP","CSK","CRABP1","TPM4","GPATCH11","UCHL1","ITGB1","KLC2","IL17RD","SAP30BP","SBK1","TRIM46","NPLOC4","APPL1","ARFGEF1","MYO10","PLK3","NPPB","XPOT","ZFP64","STK39","SYN1","MAP4K4","ZFYVE9","ARMCX2","RHEB","CCAR1","PRSS22","PTAR1","KBTBD2","HSBP1L1","ACTR2","TRIM33","PNO1","SYT6","HSPA13","UBTD1","TAB2","ESF1","FZD2","CHRNB1","LEF1","VPS37A","GCNT2","SS18","SYNJ2","TMEM132A","CALCRL","ZZZ3","TMSB4Y","LATS1","FAM104B","RNF121","PITPNB","PTPRN","GLI1","TMEM39B","CAMSAP1","ZNRF2","PLAA","PTGES3","PXDN","ELL2","MOB4","EXOC5","PDCL","BZW1","TMEM47","ZNF274","NBN","PAPOLA","TMEM158","SMC5","PDZRN3","AK1","TRRAP","WASL","SERP1","NCOA7","ZNF322","TSG101","PRMT5","USP10","PTPN21","RASSF8","DYRK2","FOXJ3","SENP6","PPARGC1B","ACTA1","LSM14B","UBQLN2","ARID3A","PSMC6","CAB39","MTX3","RBBP5","GPER1","ITFG2","KCTD3","UBE2J2","TNK2","WWP1","ANXA8L1","ANXA8","LPIN3","CSRNP2","MALT1","LRRC47","PPRC1","RIOK2","PCGF3","RAD54L2","XPO4","ATP2A2","EVI5","ADCYAP1R1","ZFP91","HK2","SSX2IP","TRIM27","MYADM","GOLIM4","GRHL2","DCUN1D1","SRI","CLTC","TRIP10","ZNF148","SMAD1","UBFD1","CCDC24","EIF1AD","PFN1","PFKP","JMJD6","RAI14","NUP153","MTHFD2","EFNB1","GPBP1L1","AOC2","EXT1","PDCL3","TNFAIP6","MRPL20","EHBP1L1","INO80E","RNF8","THAP1", "ZC3H15","EEF1E1","REPS1","GAD1","CNOT7","RASA3","TWF1","AP1G1","PEPD","WRNIP1","MAML1","TNC","SMARCE1","RAB11B","CEBPA","RIPK1","CHSY1","INIP","GNB1","R3HCC1","EFNB2","ARHGEF40","BAG2","GDPD1","PLS3","MTERF3","PIGG","SMARCD1","NPAS4","USP9X","ATXN2L","ARFIP1","SHROOM2","FBXO21","GLIS2","CEMIP","TTC33","GSTO1","ARID1A","SAMD14","YAF2","TXNDC17","SEMA4C","ATN1","CRCP","HYOU1","TMBIM1","PYGO2","LYSMD2","FLRT2","MSL1","BDH1","KCNN4","NHLRC2","PHLDA3","EIF2S1","ARHGAP32","PHYHIP","TRIM9","CGN","BMPR2","YWHAG","KCMF1","PLP2","PLEKHA5","SP4","MCAM","ESYT2","TBX18","PPM1B","KALRN","ANKRA2","CXADR")
gene_list_too_long_3 <- c( "LMAN1L","WDR45B","NAA15","NOL4L","LOXL2","ANXA6","TRIM36","NOL10","TNPO3","UBE2D1","ANKRD11","UBE2K","OLFM2","POLR2C","RFXANK","RABEP2","IFRD1","EXOC1","NAP1L4","SERPINE1","RABGEF1","POLR3B","GAR1","TJP1","OSBPL3","RAB11FIP4","SSBP1","IPPK","FAM118B","DDX31","KLC1","SPSB4","ZNF236","SRP9","PTGS2","TP53BP2","EPHA3","RPF1","PDE4D","WNT1","FAM118A","SMIM14","ZDHHC5","FEZ2","FSTL3","ABR","FZD6","DAD1","TSPYL2","RALA","CD24","DVL3","NPR3","CSNK1G1","TRAPPC13","GPSM1","ALKBH8","CRISPLD2","ACTN1","ACTR1B","RAB11FIP1","SEC24B","KLF11","NOL4","BCL7A","HTATSF1","BRWD1","GTPBP4","SCAF4","RUFY1","FNBP1L","FIZ1","C1GALT1","ARHGDIA","RAP2A","SCAMP5","TMOD2","KRT79","PHF10","USP7","PRPF39","SLC35E4","JUNB","STX6","ZNF207","NRBP1","GTF3C4","GATA2","DNAJB12","MAGOH","ZBTB1","PITHD1","RPS6KA2","SHMT2","RASL12","CUL1","YTHDF2","POGZ","CYP51A1","SBDS","USP31","AMMECR1L","CTNNA1","POLB","DDX21","LRRC8A","HNRNPCL1","HNRNPCL4","HNRNPCL2","HNRNPCL3","RASSF3","MORC2","TBC1D1","CTTNBP2NL","CDC14B","CDC14C","NOVA1","GATA3","SKI","DNAJC11","METAP1","DHX15","EFNA1","HAVCR2","EIF2S2","UBE2N","RAD17","SYNGR3","CEBPB","DDX18","SPRY4","SPATA5","TTC19","MYL9","BRIX1","NCBP1","FUBP3","CCSAP","MYLK2","TAF9","SAFB","GAB2","WDR74","CREB3L1","BZW2","PHF20L1","RC3H1","RNF122","BAZ1A","PUF60","NUP54","GP1BB","KAT5","WASF1","RAB39B","NTAQ1","FBXO22","CCDC86","INTS12","PTCH2","BMS1","ATG16L1","BBS12","EIF1B","AMOTL2","ZNF878","PLOD2","PACS1","PTBP2","TFG","ZNF532","RBM6","SLC4A7","PITPNC1","BYSL","E2F6","PHF14","VEGFC","AMOT","PHF12","CYP26B1","WDR1","UAP1","DMTF1","TPR","HRH1","ABCE1","LDB1","SNAPC3","LSP1","IBTK","ZNF592","DOT1L","ARL13B","NUDT15","APCDD1","SUPT16H","PRRC1","LAS1L","YWHAH","MANF","SPRYD7","CPSF7","IL1A","ATP9A","ZMAT3","SEMA4D","CASP8","ZNF142","ARF4","E2F4","INTS7","RSF1","CLU","ZBTB44","CCT2","GZMM","CUL3","CYTH2","GCNT1","STRBP","PRSS23","STRN3","SF3B1","CEP85","INO80","ATAD2B","ZFP57","CD1D","NAF1","DCUN1D5","PABPN1","PIN1","CRIP2","JAG1","ITCH","ITSN1","PPAN","DR1","RHBDF1","AKAP11","GADD45A","OTUD6B","AVPI1","MAPKBP1","RFTN2","IMP4","CLSTN1","USO1","RTKN","BRPF1","STX7","ERP44","PPID","DHX38","ERC1","PHLPP1","TMEM245","CFI","TMEM201","CDIPT","SMCO4","ORC4","ZFR","DNAJC1","CAMK2N1","RBBP6","TCF4","TIRAP","FHL3","STAU2","PXDC1","COL17A1","BMPR1B","C15orf39","WDR47","ADRA2A","MICAL1" )
gene_list_too_long_4 <- c( "MORC4","SDCBP2","ZNF250","SPATA13","KCTD12","FLNA","SHF","ZDHHC16","SUPT20H","NF2","SLC22A4","MYH10","THUMPD1","ZCCHC9","TMEM151A","PCDH1","MIEF1","BUD31","TRIM29","TAF15","SLC25A25","TLE3","BRD4","TIPRL","CHORDC1","IL2RB","NCOA3","RHNO1","FCER1G","ARRB2","CEP104","CSNK2A2","CDYL","MICAL3","CALM1","CALM3","CALM2","CCDC102A","FAM219A","GTF2A1","C18orf21","KCNG1","SOCS5","GOLPH3","FPGS","EDRF1","MRPL16","MLLT1","TNFRSF4","NR2C2AP","WDR75","TIMM23","PTHLH","PQBP1","ACIN1","DDX54","RSL1D1","KLF10","LYN","PTPN9","TNS2","CACNA2D1","GPRIN1","DAZAP2","CABP1","TMEM33","ZMYM4","PRPF3","DROSHA","ITGB1BP2","AKTIP","SH3BP2","HNRNPL","ADIPOR2","SAFB2","NANS","SNX7","DDHD1","ZNF800","RAB21","FUS","ZNF827","ZBTB47","HOXA3","ISL2","RBM25","RSL24D1","CBX1","UCK1","ADAMTS4","MAFA","GORASP2","EIF3A","PSMD7","TMX1","RNF19A","SAP25","PRX","ADAMTSL3","SMYD5","RANBP2","USF2","PAFAH1B1","FBN1","RBSN","ENY2","RAB3C","ADGRG5","TMEM11","CLIP2","STAM","TBXT","OTUD7B","GTF2E1","PLRG1","CBFB","TMEM59L","OSBPL11","OSBP2","POLR2H","CEP170","GPN2","FCRLB","PFDN1","SMAD4","PPP2R2A","DDX5","NRARP","RNF103","PRPF4B","ACSL4","IARS1","SGTB","FBXO11","WDR4","DDX52","GGNBP2","MAPKAPK2","CUL5","SRP54","RGS16","SNX11","F2RL2","CFAP20","ACBD3","NT5E","ZNF778","ZNF487","PDE12","PELP1","PPP1R15A","GRB2","HAS1","SLCO5A1","GLS2","CKB","TMED2","ADGRL3","B4GALT1","KLRB1","LIMK1","GTF3C3","ACSL3","HIF1AN","IL6","ZDHHC20","SLMAP","AIF1L","CCDC88A","MED7","ARID4A","KIAA1328","EIF3J","PFDN4","KLHL30","UTP6","RAB23","RICTOR","YARS2","TAF13","PCMTD1","KCNH5","TAF3","DAB2IP","DSTN","SNIP1","CCDC59","MDM2","RSRC2","ESRRA","PTK2B","FGL2","UNC5B","DDX46","THOC7","AAK1","ACTG2","TARS1","PLEKHB1","MPHOSPH10","TRA2B","GARS1","CKAP4","C4orf3","EIF4ENIF1","SP3","PDCD10","MPLKIP","POGK","TCEAL8","AMPD2","NAT14","NFXL1","HDAC7","PRDM10","BAMBI","SMOC2","CGGBP1","RUFY3","RAB2A","LGR6","KLHL11","SART1","BCLAF1","PGBD5","PAWR","SIN3B","DPP9","PKP3","MMP17","CREB1","SH2B1","FBXW11","NOP14","PRCC","TMEM81","TOMM34","DDX47","BPTF","ETS2","BATF3","ASTE1","GPT2","ZBTB21" )
marker_gene_list <- list(c( gene_list_too_long_1 , gene_list_too_long_2, gene_list_too_long_3, gene_list_too_long_4 ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "CAF NOT mNF+T HSP90A specific genes_UP_score")
FeaturePlot(Breast.srat.combined, features = "CAF NOT mNF+T HSP90A specific genes_UP_score1")

marker_gene_list <- list(c( "FHL1","BASP1","AXL","FBLN1","CTGF","TIMP3","CCL2","COL8A1","FIBIN","EFEMP2","LHFP","PLAU","NDN","SLC24A3","RGS16","COL11A1","INHBA","F3","TNFAIP6","FRZB","NDE1","S1PR3","WNT2B","CXCL1","SVEP1","KDELR3","FBLN5","SYDE1","SEPT11","MARCKS","CHN1","ZMAT3","AKAP12","LMO4","AKR1B1","PPP1R14A","NOTCH2","ADAMTSL4","TPM1","WISP1","CRMP1","GPR176","DCBLD2","TPBG","PELO","ADM","CXCL10","GXYLT2","ERRFI1","ANTXR2","APCDD1","GPX7","MAN1C1","PARVA","STEAP2","SMARCA1","ACTG2","STEAP1","YAP1","RNF144A","SMTN","FHL2","MOXD1","NEXN","FARP1","C2CD2","CYP1B1","FST","LCAT","MICALL2","TEAD1","EPHA3","PDLIM2","MEST","WBSCR17","KIAA1199","HSPA12A","NUCKS1","KIAA1211","HAS2","NCS1","NEK6","SSR1","UCN2","SGMS2","CTF1","MLLT1","IL6","ZAK","RAB23","CTDSPL","PFKFB4","ZNF668","PDE5A","HNRNPA0","ANGPTL4","KIAA0146","SEMA3C","GUCY1A2","LRP11","PTPN21","FAT1","TSKU","PCDH19","CREB3L1","EME1","WT1","MORC4","CA12","JPH2","CHID1","JUB","GPC4","DYRK3","DTX4","PARM1","PRPS2","PDXK","CMTM4","GPRC5A","KLF5","CD24" ))
Breast.srat.combined <- AddModuleScore(Breast.srat.combined, features = marker_gene_list, name = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score")
FeaturePlot(Breast.srat.combined, features = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1")

FeaturePlot(Breast.srat.combined, features = c( "HSP90AA1","HSP90AB1","HSPA1A","HSPA1B" ))
FeaturePlot(Breast.srat.combined, features = c( "STIP1","FKBP4","FKBP5","PPID" ))
FeaturePlot(Breast.srat.combined, features = c( "AIP","STUB1","PPP5C","DNAJC7" ))
FeaturePlot(Breast.srat.combined, features = c( "SUGT1P1","UNC45B","TTC4","TOMM70A" ))
FeaturePlot(Breast.srat.combined, features = c( "RPAP3","AHSA1","PTGES3","CDC37" ))
FeaturePlot(Breast.srat.combined, features = c( "CHORDC1","NUDC","YAP1" ))

```

Gene and expression breast fibroblasts

```{r gene expression Breast fibroblasts}

DefaultAssay(Breast.srat.fibroblasts.only) <- "SCT"

marker_gene_list <- list(c( "KRT1","LUM","PHLDA1","C5ORF13","PRRX1","EIF1AX","GPR56","RUNX1","POU2AF1","MOK","HN1","GTPBP8","TARBP1","EREG","SFRP4","COL1A1","CXCL12","MARCKS","COL5A1","FAP","XIST","TGFBI","TCTA","EPHA3","LEF1","SATB1","SATB2","SERPINE1","SERPINE2","CRABP2","TNC","CALML5","CXCL14","LOXL1","FOXO3","SLC5A6","HOXA10","COMP","TRBC1","CDH2","DPYSL3","MYC","SPOCK1","CYP1B1","GRB10","EGR1","CPA3","JAG1","NOP16","SMAD1","IGFBP3","INHBA","AMMECR1","ACLY","SQLE","FOSL1","LOX","SNAI2","IGKV4-1","FBN1","BIRC3","IL7R","INSIG1","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","CNN3","LGALS3","C1QTNF3","NETO2","ANPEP","AMDHD2","HMOX1","SOX9","IER3","EIF5A","MMP2","GGH","MMP3","GFPT2","CFLAR","VEGFC","LIF","TUBB2A","MTSS1","PDZK1IP1","IGLJ3","MFAP5","VCAN","MFAP2","CPE","CD27","TAX1BP3","CD24","ITK","KHDRBS3","COL14A1","TNFAIP6","PEA15","SGPL1","DSE","RRAS2","COL10A1","RRS1","CCR7","MAN1A1","LMCD1","CEP170","DACT1","SERPINB4","IL32","SERPINB3","TMEM176B","ADAM12","BGN","KLF4","ASPN","KLF7","TMEM158","GREM1","FABP5","STK17A","ALDH1A3","LRRC15","IGHM","LRRC17","SEMA3C","THBS1","MSMO1","THBS2","ATP5G1","ROBO1","POLD4","SPTLC2","PTPRZ1","LEPROTL1","COL11A1","AGA","CCL2","ITGAV","CD59","CCL19","EPHB2","CYTH1" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "LJP005_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "LJP005_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "TFAP2B","PDGFRA","PHLDA1","C5ORF13","TLE1","MX1","S100A2","MOK","TM4SF1","SFRP4","IFI44L","SCD","AXL","COL5A1","XIST","SCG2","CNIH4","DEGS1","LEF1","SERPINE1","SERPINE2","TNC","CXCL14","LOXL1","COMP","NT5E","DPYSL3","MYC","SPOCK1","NPTX2","GRB10","PHLDA2","LDLR","FDFT1","IGFBP2","CARD10","JAG1","PMM2","SMAD1","IGFBP3","C13ORF15","INHBA","PRKCA","FOSL1","SLC6A8","EIF5","LOX","MAL","PRPF4","COL6A2","SNAI2","CDC42EP3","TAGLN2","IL7R","SPON1","INSIG1","AK4","PLAU","HIF1A","ELK3","C3","CNN3","RGS3","MICAL2","FAM162A","NKX3-1","KIAA0226L","IER3","FGFBP1","MMP7","JUN","TNFRSF12A","GFPT2","CFLAR","EMP1","APOA2","NRG1","TUBB2A","CDC42BPA","MTSS1","ENAH","PDZK1IP1","MMP10","NFKBIA","VCAN","TF","ARL4C","TUBB2B","ID1","CILP","ITGA6","TAX1BP3","CD24","NVL","REG3A","NID1","AEBP1","TNFAIP2","HK1","UCHL1","COL10A1","LMCD1","PACSIN2","IL32","EGLN3","SPAG4","BGN","SULF1","KLF4","RNASE1","GAL","KLF7","CLEC2B","KLF6","PALLD","ALDH1A3","NDUFA4L2","SPRY4","TRIB2","SRPX","LRRC15","IGHM","ECM1","THBS1","THBS2","COL11A1","BNIP3","CCL2","ITGAV","UPP1","EPHB2" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "LJP009_HA1E_24H-tanespimycin-10_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "LJP009_HA1E_24H-tanespimycin-10_score1")

marker_gene_list <- list(c( "ANXA1","EIF5A","CDKN2A","F2R","AMFR","EIF2S3","COL1A2","BST2","VCAN","COL3A1","GREM1","FABP5","ID3","PLBD1","PFN2","CD24","TLR4","FGFR3","TMEM45A","IL7R","IFITM2","SPARC","NRN1","IFITM3","TYRP1","SATB1","IFITM1","HBB","ADM","KRT23","IFI6","KRT20","THBS2","LOXL2","CTSS","CYR61","HOXA10","ARHGDIA","THBD","UCHL1","ARHGDIB","COL11A1","CD59","CD36" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "LJP006_BT20_3H-geldanamycin-10_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "LJP006_BT20_3H-geldanamycin-10_score1")

marker_gene_list <- list(c( "SLC16A1","PDGFRA","PHLDA1","C5ORF13","TLE1","LMO4","GPR56","MOK","HN1","VCAM1","COL1A1","WT1","CXCL12","BOP1","IGL","AXL","CRISPLD2","COL5A1","FAP","CD9","ITGBL1","CYP1A1","PRSS2","SERPINE1","ODC1","SERPINE2","TNC","LOXL1","HOXA10","EFNB2","COMP","TUBB6","TRBC1","CDH2","DPYSL3","ALOX5","PEG10","MYC","IGKC","TPM1","SPOCK1","CYP1B1","GRB10","ARHGEF40","EGR1","CPA3","POSTN","JAG1","EGR3","IGFBP3","INHBA","IGF1","MINA","MAFB","CKAP4","ACLY","SQLE","FOSL1","CREB1","EIF5","COL6A1","LOX","COL6A2","SPATS2L","SNAI2","FBN1","CFD","SPON2","ATP6V1D","INSIG1","PDGFC","GATA6","AK4","MT1X","PLAU","COPS7A","PLAT","HIF1A","ELK3","LIPA","C3","LGALS3","C1QTNF3","C7","ANPEP","AMDHD2","PMEPA1","TSPAN7","HMOX1","TPSAB1","IER3","MMP2","GGH","GFPT2","CFLAR","EMP1","VEGFC","FN1","LIF","TUBB2A","MTSS1","MFAP5","VCAN","RAP2B","MEIS1","MFAP4","ALB","BHLHE40","CILP","FXYD2","TAX1BP3","COL14A1","TNFAIP8","THY1","CLEC7A","TIMP3","RRS1","LMCD1","PCK2","DACT1","TIMM8B","SERPINB2","IL32","ADAM12","QPCT","AKR1C3","LSS","KLF2","ASPN","KLF7","TMEM158","CLEC2B","FABP5","RPIA","ALDH1A3","MAP1B","VDAC1","CD44","SRPX","LRRC15","IGHM","LRRC17","F13A1","AMIGO2","SEMA3C","THBS1","AFP","SRM","THBS2","POLD4","AKAP12","ADAMTS1","PNMA1","NEFL","CCL2","ITGAV","EPHB2","CYTH1" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "LJP006_HA1E_24H-radicicol-1.11_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "LJP006_HA1E_24H-radicicol-1.11_score1")

marker_gene_list <- list(c( "COL11A1","ZNF469","SULF1","FAP","KIF26B","MMP11","NOX4","COL5A2","GRP","COL10A1","TBC1D8B","CTSK","TBX15","COMP","FNDC1","RASAL2","HEYL","WISP1","COL8A1","ANTXR1","CNIH3","OLFML2B","CMTM8","LAYN","THBS2","ZNF587","IL13RA1","SIRPA","FKBP9","FGF18","ANGPT2","NOTCH4","GZMB","CHSY1","MMP7","RNF149","LOXL1","MRPS10","LAMP1","FBN1","MYH9","EXOC5","MORC4","IFITM1","CD93","PNPO","APBB2","PCDH17","KCNQ1","EGFL6","CDS2","SULF2","AMDHD2","ITPK1","CTDSP2","ARF4","GALNT10","SOCS3","IGFBP7","FBXO22","LRRC32","BCL2L1","ADAM12","ARL8A","MAML1","ADAMTS2","ITGA11","ELMOD2","HSD3B7","CECR5","TMEM109","DNAJB2","SPIN3","JUNB","GALNT1","RAI1","EHMT1","WSB2","AEBP1","ARMCX5","SPARC","INHBA","EVC","MAPRE1","CD248","BPGM","PPAPDC1A","C2","STARD3NL","ALDH1A3","PCBD1","CTHRC1","PDPN","ATP2A2","CYFIP1","DDAH2","TMEM30A","PQLC3","PCDHB10","HSPH1","PCID2","KAL1","LAMP2","RNF187","CCDC92","KRT23","NCK2","RAB15","BMP1","TNFSF4","CXCL2","PTPN12","CMTM4","ZNF668","SEPT8","ADAMTS6","QDPR","C1QTNF6","OSM","MYH10","SUMF1","IMPACT","GLB1","EDNRA","ANKH","CNP","B3GALT6","DYNLT1","MMP16","CD3EAP","SFXN3","RAB18","ABL2","DKK2","ELMO2","FZD8","LRRC15","PTP4A3","IFITM3","SEMA5A","ATP6V1C1","PPEF1","TRAM1","DDB1","FOLH1","BICC1","ADAMTS12","GLMP","TGFBRAP1","MFAP2","TMEM132A","C8orf34","FBXL20","GOLGA5","NECAP2","EFNB2","BAP1","IFITM2","BZW2","CXCL10","PTPLAD1","ISLR","GNB1","SCYL2","RAB40C","GJA5","SPOUT1","FASTKD2","PEX7","DEXI","MYB","GTF3C1","CD82","DIAPH3","ABHD11","UBAP2","KDR","HOXB8","KIF9","EFEMP2","XPO4","CLTC","DIABLO","CALU","ZNF282","TRIM29","CXCL6","CSNK1G3","VPS41","TMCO3","EPHB2","STARD4","PTPRG","TRIM68","EXOSC4","POLE3","PRPF4","SOX9","NEK1","FJX1","CACNA1D","HECW2","ADCK2","SLC12A8","DUSP14","JAG2","PIGW","TMED1" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "STROMA hi BC OV CR_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "STROMA hi BC OV CR_score1")

gene_list_too_long_1 <- c( "FGF2","PKP1","INHBA","JUP","ADCY7","SLC20A1","ENDOD1","TUBB3","HBEGF","NES","SEMA7A","WHRN","TNNT2","CNNM4","ITGB3","TRIM66","HR","MEGF10","OLR1","LRRC8C","ARL4C","CMKLR1","NIPAL1","LAD1","DUSP6","MED14","THBS1","WNT5A","PMAIP1","KCTD11","NUAK2","ZC3H12C","COQ10B","MN1","TBX3","SKIL","CTDP1","BHLHE40","ZSWIM6","WNT11","RAP1GAP2","PIEZO2","PMEPA1","VEGFA","TNFRSF21","IRAK2","MYO1E","CARD10","IGF2BP3","MAP6","SEC14L2","RYBP","LRRC8B","GREM2","SMAD7","TMCC2","PCDH7","ASAP2","ITGA5","COTL1","DZIP1L","LAMB3","TTC39B","GPR39","SCHIP1","PLAU","PHTF2","PTGS1","DENR","GDPD5","PPP1R13L","HOMER1","MOB3B","VOPP1","RDH10","FKBP5","F2R","MICAL2","YWHAQ","CNTN2","BLCAP","OTUD4","KANSL3","PIP4K2A","PLAUR","RASA1","SLC7A1","POLR3D","ZFPM1","ARPC2","LRRC15","NRIP1","IGSF3","PKIA","NIN","ACOT7","IVNS1ABP","PRG4","SLC25A30","ABRACL","ANO1","OSGIN2","ARID5A","RUNX1","TGIF1","CBLB","TUBA1A","NAV1","PRKG2","COL5A3","LRRC75A","KIAA1671","ARNT2","TNS3","CAMSAP2","ZNF451","RNF19B","MTFR1","AP1S3","SMOC1","PHYHIPL","CHST11","ANTXR2","GPR161","MLLT11","ADCY1","RGS20","SYT11","TAGLN","AGO2","SPSB1","SORCS2","CNN3","NNT","DOCK8","PLAGL1","SEPT11","DGCR8","NCOR2","ZMIZ1","AHCY","SH3BGRL2","LARP1B","RAB31","GOLM1","ZYX","KLHDC8A","CSNK1E","FOXN2","SMURF2","ACSL6","SOCS2","TMSB10","DDAH1","EVA1A","ALCAM","RELT","ARHGEF5","PSTPIP2","EGR2","FOXP4","B4GALNT1","FBLIM1","ADNP","ANGPTL4","PIK3C2B","RRN3","DBN1","ANKRD1","ZBED4","ADRM1","WNT7B","KPNA4","CTSF","HOMER3","PLEKHG3","RBMS1","CDR2","UTP18","BOK","TMEFF1","CYTH4","RTN2","PIM1","HES1","NFKB1","TATDN2","BPIFC","LMCD1","DPYSL3","TNS1","UCN2","AGAP1","L3MBTL3","SMIM15","BRD1","RRS1","SYDE2","GLI3","LTV1","UTRN","CTSW","CD200","MAST4","IL11","PRR5","MYH9","ZNF266","KCNN3","B3GNT2","UBXN2A","DDAH2","CCDC97","NEDD9","LUZP1","PFKFB4","EAF1","IDH3A","LIN7C","NFATC1","SMTN","RNF4","C1QL1","FUBP1","SNAI1","ANKH","MAFF","PTPN12","FASTKD5","SLC39A6","PHLDB2","TES","HACE1","MYO19","IL34","FBXO30","TIMP1","EIF4G2","TMEM200A","CDYL2","ATP2B4","HMCN2","JADE1","PRDM1","SSR3","CDV3","STARD10","ARIH1","CCDC34","CHD1","WNT9A","PDZD8","MYO1D","FES","GABPB1","KCNH1","CRLF1","DNAJC21","ACTG1","RDH8","TPM3","TANC1","FBXL16","FERMT2","E2F3","LITAF","SUCO","USP34","TAGLN2","LYSMD3","PAK4","NOP58","MPHOSPH6","CDC42SE2","GRK6","RNF6","HSPA4","DNAJA4","UBE2J1","ERCC1","KPNA1","ATP1A3","CDC73","VASH1","MAFG","FOXP1","PDLIM7","CDK12","GLCE","ATG9B","CXorf38","CSRP1","RAP1GAP","ACTB","ZNF362","TAB3","GK5","SEMA6A","ZNF518A","ELAVL1","RAB6A","MSN","YLPM1","MTMR7","GABBR1","FRK","SMAD2","IRS2","NAPG","FPGT","ATF4","M6PR","IRF2BPL","AKIRIN1","KCTD15","TMEM168","PARD3","TPD52","TEC","CCDC112","COL27A1","LIMD1","ARMC5","FAM156B","FAM156A","FYN","RAPH1","OSBPL6","PHF2","PPHLN1","KCNK12","IER2","DHX33","SPRED1","RAB11FIP3","NMD3","LDLRAD4","DLG3","GJA4","USP39","CACNA1I","CHML","ZNF821","WDFY3","FURIN","CHD5","LRP5","SHROOM3","MCF2L","SWAP70","EPC2","UBE2F","NCOA6","PPP3R1" )
gene_list_too_long_2 <- c( "PRKRIP1","PTGFRN","TUFT1","UNC45A","TYW5","PREP","CSK","CRABP1","TPM4","GPATCH11","UCHL1","ITGB1","KLC2","IL17RD","SAP30BP","SBK1","TRIM46","NPLOC4","APPL1","ARFGEF1","MYO10","PLK3","NPPB","XPOT","ZFP64","STK39","SYN1","MAP4K4","ZFYVE9","ARMCX2","RHEB","CCAR1","PRSS22","PTAR1","KBTBD2","HSBP1L1","ACTR2","TRIM33","PNO1","SYT6","HSPA13","UBTD1","TAB2","ESF1","FZD2","CHRNB1","LEF1","VPS37A","GCNT2","SS18","SYNJ2","TMEM132A","CALCRL","ZZZ3","TMSB4Y","LATS1","FAM104B","RNF121","PITPNB","PTPRN","GLI1","TMEM39B","CAMSAP1","ZNRF2","PLAA","PTGES3","PXDN","ELL2","MOB4","EXOC5","PDCL","BZW1","TMEM47","ZNF274","NBN","PAPOLA","TMEM158","SMC5","PDZRN3","AK1","TRRAP","WASL","SERP1","NCOA7","ZNF322","TSG101","PRMT5","USP10","PTPN21","RASSF8","DYRK2","FOXJ3","SENP6","PPARGC1B","ACTA1","LSM14B","UBQLN2","ARID3A","PSMC6","CAB39","MTX3","RBBP5","GPER1","ITFG2","KCTD3","UBE2J2","TNK2","WWP1","ANXA8L1","ANXA8","LPIN3","CSRNP2","MALT1","LRRC47","PPRC1","RIOK2","PCGF3","RAD54L2","XPO4","ATP2A2","EVI5","ADCYAP1R1","ZFP91","HK2","SSX2IP","TRIM27","MYADM","GOLIM4","GRHL2","DCUN1D1","SRI","CLTC","TRIP10","ZNF148","SMAD1","UBFD1","CCDC24","EIF1AD","PFN1","PFKP","JMJD6","RAI14","NUP153","MTHFD2","EFNB1","GPBP1L1","AOC2","EXT1","PDCL3","TNFAIP6","MRPL20","EHBP1L1","INO80E","RNF8","THAP1", "ZC3H15","EEF1E1","REPS1","GAD1","CNOT7","RASA3","TWF1","AP1G1","PEPD","WRNIP1","MAML1","TNC","SMARCE1","RAB11B","CEBPA","RIPK1","CHSY1","INIP","GNB1","R3HCC1","EFNB2","ARHGEF40","BAG2","GDPD1","PLS3","MTERF3","PIGG","SMARCD1","NPAS4","USP9X","ATXN2L","ARFIP1","SHROOM2","FBXO21","GLIS2","CEMIP","TTC33","GSTO1","ARID1A","SAMD14","YAF2","TXNDC17","SEMA4C","ATN1","CRCP","HYOU1","TMBIM1","PYGO2","LYSMD2","FLRT2","MSL1","BDH1","KCNN4","NHLRC2","PHLDA3","EIF2S1","ARHGAP32","PHYHIP","TRIM9","CGN","BMPR2","YWHAG","KCMF1","PLP2","PLEKHA5","SP4","MCAM","ESYT2","TBX18","PPM1B","KALRN","ANKRA2","CXADR")
gene_list_too_long_3 <- c( "LMAN1L","WDR45B","NAA15","NOL4L","LOXL2","ANXA6","TRIM36","NOL10","TNPO3","UBE2D1","ANKRD11","UBE2K","OLFM2","POLR2C","RFXANK","RABEP2","IFRD1","EXOC1","NAP1L4","SERPINE1","RABGEF1","POLR3B","GAR1","TJP1","OSBPL3","RAB11FIP4","SSBP1","IPPK","FAM118B","DDX31","KLC1","SPSB4","ZNF236","SRP9","PTGS2","TP53BP2","EPHA3","RPF1","PDE4D","WNT1","FAM118A","SMIM14","ZDHHC5","FEZ2","FSTL3","ABR","FZD6","DAD1","TSPYL2","RALA","CD24","DVL3","NPR3","CSNK1G1","TRAPPC13","GPSM1","ALKBH8","CRISPLD2","ACTN1","ACTR1B","RAB11FIP1","SEC24B","KLF11","NOL4","BCL7A","HTATSF1","BRWD1","GTPBP4","SCAF4","RUFY1","FNBP1L","FIZ1","C1GALT1","ARHGDIA","RAP2A","SCAMP5","TMOD2","KRT79","PHF10","USP7","PRPF39","SLC35E4","JUNB","STX6","ZNF207","NRBP1","GTF3C4","GATA2","DNAJB12","MAGOH","ZBTB1","PITHD1","RPS6KA2","SHMT2","RASL12","CUL1","YTHDF2","POGZ","CYP51A1","SBDS","USP31","AMMECR1L","CTNNA1","POLB","DDX21","LRRC8A","HNRNPCL1","HNRNPCL4","HNRNPCL2","HNRNPCL3","RASSF3","MORC2","TBC1D1","CTTNBP2NL","CDC14B","CDC14C","NOVA1","GATA3","SKI","DNAJC11","METAP1","DHX15","EFNA1","HAVCR2","EIF2S2","UBE2N","RAD17","SYNGR3","CEBPB","DDX18","SPRY4","SPATA5","TTC19","MYL9","BRIX1","NCBP1","FUBP3","CCSAP","MYLK2","TAF9","SAFB","GAB2","WDR74","CREB3L1","BZW2","PHF20L1","RC3H1","RNF122","BAZ1A","PUF60","NUP54","GP1BB","KAT5","WASF1","RAB39B","NTAQ1","FBXO22","CCDC86","INTS12","PTCH2","BMS1","ATG16L1","BBS12","EIF1B","AMOTL2","ZNF878","PLOD2","PACS1","PTBP2","TFG","ZNF532","RBM6","SLC4A7","PITPNC1","BYSL","E2F6","PHF14","VEGFC","AMOT","PHF12","CYP26B1","WDR1","UAP1","DMTF1","TPR","HRH1","ABCE1","LDB1","SNAPC3","LSP1","IBTK","ZNF592","DOT1L","ARL13B","NUDT15","APCDD1","SUPT16H","PRRC1","LAS1L","YWHAH","MANF","SPRYD7","CPSF7","IL1A","ATP9A","ZMAT3","SEMA4D","CASP8","ZNF142","ARF4","E2F4","INTS7","RSF1","CLU","ZBTB44","CCT2","GZMM","CUL3","CYTH2","GCNT1","STRBP","PRSS23","STRN3","SF3B1","CEP85","INO80","ATAD2B","ZFP57","CD1D","NAF1","DCUN1D5","PABPN1","PIN1","CRIP2","JAG1","ITCH","ITSN1","PPAN","DR1","RHBDF1","AKAP11","GADD45A","OTUD6B","AVPI1","MAPKBP1","RFTN2","IMP4","CLSTN1","USO1","RTKN","BRPF1","STX7","ERP44","PPID","DHX38","ERC1","PHLPP1","TMEM245","CFI","TMEM201","CDIPT","SMCO4","ORC4","ZFR","DNAJC1","CAMK2N1","RBBP6","TCF4","TIRAP","FHL3","STAU2","PXDC1","COL17A1","BMPR1B","C15orf39","WDR47","ADRA2A","MICAL1" )
gene_list_too_long_4 <- c( "MORC4","SDCBP2","ZNF250","SPATA13","KCTD12","FLNA","SHF","ZDHHC16","SUPT20H","NF2","SLC22A4","MYH10","THUMPD1","ZCCHC9","TMEM151A","PCDH1","MIEF1","BUD31","TRIM29","TAF15","SLC25A25","TLE3","BRD4","TIPRL","CHORDC1","IL2RB","NCOA3","RHNO1","FCER1G","ARRB2","CEP104","CSNK2A2","CDYL","MICAL3","CALM1","CALM3","CALM2","CCDC102A","FAM219A","GTF2A1","C18orf21","KCNG1","SOCS5","GOLPH3","FPGS","EDRF1","MRPL16","MLLT1","TNFRSF4","NR2C2AP","WDR75","TIMM23","PTHLH","PQBP1","ACIN1","DDX54","RSL1D1","KLF10","LYN","PTPN9","TNS2","CACNA2D1","GPRIN1","DAZAP2","CABP1","TMEM33","ZMYM4","PRPF3","DROSHA","ITGB1BP2","AKTIP","SH3BP2","HNRNPL","ADIPOR2","SAFB2","NANS","SNX7","DDHD1","ZNF800","RAB21","FUS","ZNF827","ZBTB47","HOXA3","ISL2","RBM25","RSL24D1","CBX1","UCK1","ADAMTS4","MAFA","GORASP2","EIF3A","PSMD7","TMX1","RNF19A","SAP25","PRX","ADAMTSL3","SMYD5","RANBP2","USF2","PAFAH1B1","FBN1","RBSN","ENY2","RAB3C","ADGRG5","TMEM11","CLIP2","STAM","TBXT","OTUD7B","GTF2E1","PLRG1","CBFB","TMEM59L","OSBPL11","OSBP2","POLR2H","CEP170","GPN2","FCRLB","PFDN1","SMAD4","PPP2R2A","DDX5","NRARP","RNF103","PRPF4B","ACSL4","IARS1","SGTB","FBXO11","WDR4","DDX52","GGNBP2","MAPKAPK2","CUL5","SRP54","RGS16","SNX11","F2RL2","CFAP20","ACBD3","NT5E","ZNF778","ZNF487","PDE12","PELP1","PPP1R15A","GRB2","HAS1","SLCO5A1","GLS2","CKB","TMED2","ADGRL3","B4GALT1","KLRB1","LIMK1","GTF3C3","ACSL3","HIF1AN","IL6","ZDHHC20","SLMAP","AIF1L","CCDC88A","MED7","ARID4A","KIAA1328","EIF3J","PFDN4","KLHL30","UTP6","RAB23","RICTOR","YARS2","TAF13","PCMTD1","KCNH5","TAF3","DAB2IP","DSTN","SNIP1","CCDC59","MDM2","RSRC2","ESRRA","PTK2B","FGL2","UNC5B","DDX46","THOC7","AAK1","ACTG2","TARS1","PLEKHB1","MPHOSPH10","TRA2B","GARS1","CKAP4","C4orf3","EIF4ENIF1","SP3","PDCD10","MPLKIP","POGK","TCEAL8","AMPD2","NAT14","NFXL1","HDAC7","PRDM10","BAMBI","SMOC2","CGGBP1","RUFY3","RAB2A","LGR6","KLHL11","SART1","BCLAF1","PGBD5","PAWR","SIN3B","DPP9","PKP3","MMP17","CREB1","SH2B1","FBXW11","NOP14","PRCC","TMEM81","TOMM34","DDX47","BPTF","ETS2","BATF3","ASTE1","GPT2","ZBTB21" )
marker_gene_list <- list(c( gene_list_too_long_1 , gene_list_too_long_2, gene_list_too_long_3, gene_list_too_long_4 ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "CAF NOT mNF+T HSP90A specific genes_UP_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "CAF NOT mNF+T HSP90A specific genes_UP_score1")

marker_gene_list <- list(c( "FHL1","BASP1","AXL","FBLN1","CTGF","TIMP3","CCL2","COL8A1","FIBIN","EFEMP2","LHFP","PLAU","NDN","SLC24A3","RGS16","COL11A1","INHBA","F3","TNFAIP6","FRZB","NDE1","S1PR3","WNT2B","CXCL1","SVEP1","KDELR3","FBLN5","SYDE1","SEPT11","MARCKS","CHN1","ZMAT3","AKAP12","LMO4","AKR1B1","PPP1R14A","NOTCH2","ADAMTSL4","TPM1","WISP1","CRMP1","GPR176","DCBLD2","TPBG","PELO","ADM","CXCL10","GXYLT2","ERRFI1","ANTXR2","APCDD1","GPX7","MAN1C1","PARVA","STEAP2","SMARCA1","ACTG2","STEAP1","YAP1","RNF144A","SMTN","FHL2","MOXD1","NEXN","FARP1","C2CD2","CYP1B1","FST","LCAT","MICALL2","TEAD1","EPHA3","PDLIM2","MEST","WBSCR17","KIAA1199","HSPA12A","NUCKS1","KIAA1211","HAS2","NCS1","NEK6","SSR1","UCN2","SGMS2","CTF1","MLLT1","IL6","ZAK","RAB23","CTDSPL","PFKFB4","ZNF668","PDE5A","HNRNPA0","ANGPTL4","KIAA0146","SEMA3C","GUCY1A2","LRP11","PTPN21","FAT1","TSKU","PCDH19","CREB3L1","EME1","WT1","MORC4","CA12","JPH2","CHID1","JUB","GPC4","DYRK3","DTX4","PARM1","PRPS2","PDXK","CMTM4","GPRC5A","KLF5","CD24" ))
Breast.srat.fibroblasts.only <- AddModuleScore(Breast.srat.fibroblasts.only, features = marker_gene_list, name = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score")
FeaturePlot(Breast.srat.fibroblasts.only, features = "CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1")

FeaturePlot(Breast.srat.fibroblasts.only, features = c( "HSP90AA1","HSP90AB1","HSPA1A","HSPA1B" ))
FeaturePlot(Breast.srat.fibroblasts.only, features = c( "STIP1","FKBP4","FKBP5","PPID" ))
FeaturePlot(Breast.srat.fibroblasts.only, features = c( "AIP","STUB1","PPP5C","DNAJC7" ))
FeaturePlot(Breast.srat.fibroblasts.only, features = c( "SUGT1P1","UNC45B","TTC4","TOMM70A" ))
FeaturePlot(Breast.srat.fibroblasts.only, features = c( "RPAP3","AHSA1","PTGES3","CDC37" ))
FeaturePlot(Breast.srat.fibroblasts.only, features = c( "CHORDC1","NUDC","YAP1" ))

```


## 4. Expression matrix (average) so we can generate a heatmap or graph (gene and signatures)

I created the tables containing for every cell: normalised expression values per gene, signature value, cluster assigned, and celltype assigned.

Bladder

```{r heatmap Bladder}

Bladder.table <- data.frame(
  HSP90AA1 = FetchData(Bladder.srat.combined, vars = "HSP90AA1"),
  HSP90AB1 = FetchData(Bladder.srat.combined, vars = "HSP90AB1"),
  HSPA1A = FetchData(Bladder.srat.combined, vars = "HSPA1A"),
  HSPA1B = FetchData(Bladder.srat.combined, vars = "HSPA1B"),
  STIP1 = FetchData(Bladder.srat.combined, vars = "STIP1"),
  FKBP4 = FetchData(Bladder.srat.combined, vars = "FKBP4"),
  FKBP5 = FetchData(Bladder.srat.combined, vars = "FKBP5"),
  PPID = FetchData(Bladder.srat.combined, vars = "PPID"),
  AIP = FetchData(Bladder.srat.combined, vars = "AIP"),
  STUB1 = FetchData(Bladder.srat.combined, vars = "STUB1"),
  PPP5C = FetchData(Bladder.srat.combined, vars = "PPP5C"),
  DNAJC7 = FetchData(Bladder.srat.combined, vars = "DNAJC7"),
  SUGT1P1 = NA,
  UNC45B = FetchData(Bladder.srat.combined, vars = "UNC45B"),
  TTC4 = FetchData(Bladder.srat.combined, vars = "TTC4"),
  TOMM70A = NA,
  RPAP3 = FetchData(Bladder.srat.combined, vars = "RPAP3"),
  AHSA1 = FetchData(Bladder.srat.combined, vars = "AHSA1"),
  PTGES3 = FetchData(Bladder.srat.combined, vars = "PTGES3"),
  CDC37 = FetchData(Bladder.srat.combined, vars = "CDC37"),
  CHORDC1 = FetchData(Bladder.srat.combined, vars = "CHORDC1"),
  NUDC = FetchData(Bladder.srat.combined, vars = "NUDC"),
  YAP1 = FetchData(Bladder.srat.combined, vars = "YAP1"),
  LJP005_HA1E_24H_radicicol = Bladder.srat.combined$`LJP005_HA1E_24H-radicicol-1.11_score1`,
  LJP009_HA1E_24H_tanespimycin = Bladder.srat.combined$`LJP009_HA1E_24H-tanespimycin-10_score1`,
  LJP006_BT20_3H_geldanamycin = Bladder.srat.combined$`LJP006_BT20_3H-geldanamycin-10_score1`,
  LJP006_HA1E_24H_radicicol = Bladder.srat.combined$`LJP006_HA1E_24H-radicicol-1.11_score1`,
  STROMA_hi_BC_OV_CR = Bladder.srat.combined$`STROMA hi BC OV CR_score1`,
  CAF_NOT_mNF_T_HSP90A_specific_genes_UP = Bladder.srat.combined$`CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1`,
  CAF_specific_YAPTAZ_signature_JUST_FOLD_EPCAM = Bladder.srat.combined$`CAF NOT mNF+T HSP90A specific genes_UP_score1`,
  cluster = Bladder.srat.combined$seurat_clusters,
  cell_type = Bladder.srat.combined$hpca.main,
  tumour = Bladder.srat.combined$orig.tumour
)

write.csv(Bladder.table, file="Bladder.table.csv")

rm(Bladder.table)

```

Bladder fibroblast

```{r heatmap Bladder fibroblast}

Bladder.fibroblast.table <- data.frame(
  HSP90AA1 = FetchData(Bladder.srat.fibroblasts.only, vars = "HSP90AA1"),
  HSP90AB1 = FetchData(Bladder.srat.fibroblasts.only, vars = "HSP90AB1"),
  HSPA1A = FetchData(Bladder.srat.fibroblasts.only, vars = "HSPA1A"),
  HSPA1B = FetchData(Bladder.srat.fibroblasts.only, vars = "HSPA1B"),
  STIP1 = FetchData(Bladder.srat.fibroblasts.only, vars = "STIP1"),
  FKBP4 = FetchData(Bladder.srat.fibroblasts.only, vars = "FKBP4"),
  FKBP5 = FetchData(Bladder.srat.fibroblasts.only, vars = "FKBP5"),
  PPID = FetchData(Bladder.srat.fibroblasts.only, vars = "PPID"),
  AIP = FetchData(Bladder.srat.fibroblasts.only, vars = "AIP"),
  STUB1 = FetchData(Bladder.srat.fibroblasts.only, vars = "STUB1"),
  PPP5C = FetchData(Bladder.srat.fibroblasts.only, vars = "PPP5C"),
  DNAJC7 = FetchData(Bladder.srat.fibroblasts.only, vars = "DNAJC7"),
  SUGT1P1 = NA,
  UNC45B = FetchData(Bladder.srat.fibroblasts.only, vars = "UNC45B"),
  TTC4 = FetchData(Bladder.srat.fibroblasts.only, vars = "TTC4"),
  TOMM70A = NA,
  RPAP3 = FetchData(Bladder.srat.fibroblasts.only, vars = "RPAP3"),
  AHSA1 = FetchData(Bladder.srat.fibroblasts.only, vars = "AHSA1"),
  PTGES3 = FetchData(Bladder.srat.fibroblasts.only, vars = "PTGES3"),
  CDC37 = FetchData(Bladder.srat.fibroblasts.only, vars = "CDC37"),
  CHORDC1 = FetchData(Bladder.srat.fibroblasts.only, vars = "CHORDC1"),
  NUDC = FetchData(Bladder.srat.fibroblasts.only, vars = "NUDC"),
  YAP1 = FetchData(Bladder.srat.fibroblasts.only, vars = "YAP1"),
  LJP005_HA1E_24H_radicicol = Bladder.srat.fibroblasts.only$`LJP005_HA1E_24H-radicicol-1.11_score1`,
  LJP009_HA1E_24H_tanespimycin = Bladder.srat.fibroblasts.only$`LJP009_HA1E_24H-tanespimycin-10_score1`,
  LJP006_BT20_3H_geldanamycin = Bladder.srat.fibroblasts.only$`LJP006_BT20_3H-geldanamycin-10_score1`,
  LJP006_HA1E_24H_radicicol = Bladder.srat.fibroblasts.only$`LJP006_HA1E_24H-radicicol-1.11_score1`,
  STROMA_hi_BC_OV_CR = Bladder.srat.fibroblasts.only$`STROMA hi BC OV CR_score1`,
  CAF_NOT_mNF_T_HSP90A_specific_genes_UP = Bladder.srat.fibroblasts.only$`CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1`,
  CAF_specific_YAPTAZ_signature_JUST_FOLD_EPCAM = Bladder.srat.fibroblasts.only$`CAF NOT mNF+T HSP90A specific genes_UP_score1`,
  cluster = Bladder.srat.fibroblasts.only$seurat_clusters,
  cell_type = Bladder.srat.fibroblasts.only$hpca.main,
  tumour = Bladder.srat.fibroblasts.only$orig.tumour
)

write.csv(Bladder.fibroblast.table, file="Bladder.fibroblast.table.csv")

rm(Bladder.fibroblast.table)

```

Breast

```{r heatmap Breast}

Breast.table <- data.frame(
  HSP90AA1 = FetchData(Breast.srat.combined, vars = "HSP90AA1"),
  HSP90AB1 = FetchData(Breast.srat.combined, vars = "HSP90AB1"),
  HSPA1A = FetchData(Breast.srat.combined, vars = "HSPA1A"),
  HSPA1B = FetchData(Breast.srat.combined, vars = "HSPA1B"),
  STIP1 = FetchData(Breast.srat.combined, vars = "STIP1"),
  FKBP4 = FetchData(Breast.srat.combined, vars = "FKBP4"),
  FKBP5 = FetchData(Breast.srat.combined, vars = "FKBP5"),
  PPID = FetchData(Breast.srat.combined, vars = "PPID"),
  AIP = FetchData(Breast.srat.combined, vars = "AIP"),
  STUB1 = FetchData(Breast.srat.combined, vars = "STUB1"),
  PPP5C = FetchData(Breast.srat.combined, vars = "PPP5C"),
  DNAJC7 = FetchData(Breast.srat.combined, vars = "DNAJC7"),
  SUGT1P1 = NA,
  UNC45B = FetchData(Breast.srat.combined, vars = "UNC45B"),
  TTC4 = FetchData(Breast.srat.combined, vars = "TTC4"),
  TOMM70A = NA,
  RPAP3 = FetchData(Breast.srat.combined, vars = "RPAP3"),
  AHSA1 = FetchData(Breast.srat.combined, vars = "AHSA1"),
  PTGES3 = FetchData(Breast.srat.combined, vars = "PTGES3"),
  CDC37 = FetchData(Breast.srat.combined, vars = "CDC37"),
  CHORDC1 = FetchData(Breast.srat.combined, vars = "CHORDC1"),
  NUDC = FetchData(Breast.srat.combined, vars = "NUDC"),
  YAP1 = FetchData(Breast.srat.combined, vars = "YAP1"),
  LJP005_HA1E_24H_radicicol = Breast.srat.combined$`LJP005_HA1E_24H-radicicol-1.11_score1`,
  LJP009_HA1E_24H_tanespimycin = Breast.srat.combined$`LJP009_HA1E_24H-tanespimycin-10_score1`,
  LJP006_BT20_3H_geldanamycin = Breast.srat.combined$`LJP006_BT20_3H-geldanamycin-10_score1`,
  LJP006_HA1E_24H_radicicol = Breast.srat.combined$`LJP006_HA1E_24H-radicicol-1.11_score1`,
  STROMA_hi_BC_OV_CR = Breast.srat.combined$`STROMA hi BC OV CR_score1`,
  CAF_NOT_mNF_T_HSP90A_specific_genes_UP = Breast.srat.combined$`CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1`,
  CAF_specific_YAPTAZ_signature_JUST_FOLD_EPCAM = Breast.srat.combined$`CAF NOT mNF+T HSP90A specific genes_UP_score1`,
  cluster = Breast.srat.combined$seurat_clusters,
  cell_type = Breast.srat.combined$cell_type,
  tumour = "Tumour"
)

write.csv(Breast.table, file="Breast.table.csv")

rm(Breast.table)

```

Breast

```{r heatmap Breast fibroblasts}

Breast.fibroblasts.table <- data.frame(
  HSP90AA1 = FetchData(Breast.srat.fibroblasts.only, vars = "HSP90AA1"),
  HSP90AB1 = FetchData(Breast.srat.fibroblasts.only, vars = "HSP90AB1"),
  HSPA1A = FetchData(Breast.srat.fibroblasts.only, vars = "HSPA1A"),
  HSPA1B = FetchData(Breast.srat.fibroblasts.only, vars = "HSPA1B"),
  STIP1 = FetchData(Breast.srat.fibroblasts.only, vars = "STIP1"),
  FKBP4 = FetchData(Breast.srat.fibroblasts.only, vars = "FKBP4"),
  FKBP5 = FetchData(Breast.srat.fibroblasts.only, vars = "FKBP5"),
  PPID = FetchData(Breast.srat.fibroblasts.only, vars = "PPID"),
  AIP = FetchData(Breast.srat.fibroblasts.only, vars = "AIP"),
  STUB1 = FetchData(Breast.srat.fibroblasts.only, vars = "STUB1"),
  PPP5C = FetchData(Breast.srat.fibroblasts.only, vars = "PPP5C"),
  DNAJC7 = FetchData(Breast.srat.fibroblasts.only, vars = "DNAJC7"),
  SUGT1P1 = NA,
  UNC45B = FetchData(Breast.srat.fibroblasts.only, vars = "UNC45B"),
  TTC4 = FetchData(Breast.srat.fibroblasts.only, vars = "TTC4"),
  TOMM70A = NA,
  RPAP3 = FetchData(Breast.srat.fibroblasts.only, vars = "RPAP3"),
  AHSA1 = FetchData(Breast.srat.fibroblasts.only, vars = "AHSA1"),
  PTGES3 = FetchData(Breast.srat.fibroblasts.only, vars = "PTGES3"),
  CDC37 = FetchData(Breast.srat.fibroblasts.only, vars = "CDC37"),
  CHORDC1 = FetchData(Breast.srat.fibroblasts.only, vars = "CHORDC1"),
  NUDC = FetchData(Breast.srat.fibroblasts.only, vars = "NUDC"),
  YAP1 = FetchData(Breast.srat.fibroblasts.only, vars = "YAP1"),
  LJP005_HA1E_24H_radicicol = Breast.srat.fibroblasts.only$`LJP005_HA1E_24H-radicicol-1.11_score1`,
  LJP009_HA1E_24H_tanespimycin = Breast.srat.fibroblasts.only$`LJP009_HA1E_24H-tanespimycin-10_score1`,
  LJP006_BT20_3H_geldanamycin = Breast.srat.fibroblasts.only$`LJP006_BT20_3H-geldanamycin-10_score1`,
  LJP006_HA1E_24H_radicicol = Breast.srat.fibroblasts.only$`LJP006_HA1E_24H-radicicol-1.11_score1`,
  STROMA_hi_BC_OV_CR = Breast.srat.fibroblasts.only$`STROMA hi BC OV CR_score1`,
  CAF_NOT_mNF_T_HSP90A_specific_genes_UP = Breast.srat.fibroblasts.only$`CAF_specific YAPTAZ signature_JUST FOLD.exc EPCAM_score1`,
  CAF_specific_YAPTAZ_signature_JUST_FOLD_EPCAM = Breast.srat.fibroblasts.only$`CAF NOT mNF+T HSP90A specific genes_UP_score1`,
  cluster = Breast.srat.fibroblasts.only$seurat_clusters,
  cell_type = Breast.srat.fibroblasts.only$cell_type,
  tumour = "Tumour"
)

write.csv(Breast.fibroblasts.table, file="Breast.fibroblasts.table.csv")

rm(Breast.fibroblasts.table)

```


## 5. For the BLCA dataset that we have normal and cancer tissue, expression matrix for gene and signtures of fibroblasts from normal and tumor

Added as extra field in previous tables.
